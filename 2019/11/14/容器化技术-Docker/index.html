<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>容器化技术--Docker | GZ's Blog</title><meta name="description" content="容器化技术--Docker"><meta name="keywords" content="Linux,Docker,容器化技术"><meta name="author" content="GZ"><meta name="copyright" content="GZ"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="canonical" href="https://gz1903.github.io/2019/11/14/容器化技术-Docker/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="容器化技术--Docker"><meta name="twitter:description" content="容器化技术--Docker"><meta name="twitter:image" content="https://puui.qpic.cn/fans_admin/0/3_902214536_1573730288351/0"><meta property="og:type" content="article"><meta property="og:title" content="容器化技术--Docker"><meta property="og:url" content="https://gz1903.github.io/2019/11/14/容器化技术-Docker/"><meta property="og:site_name" content="GZ's Blog"><meta property="og:description" content="容器化技术--Docker"><meta property="og:image" content="https://puui.qpic.cn/fans_admin/0/3_902214536_1573730288351/0"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="prev" title="Dockerfile构建JDK+Tomcat环境" href="https://gz1903.github.io/2019/11/15/Dockerfile构建JDK-Tomcat环境/"><link rel="next" title="Linux科学上网搭建" href="https://gz1903.github.io/2019/11/09/Linux科学上网搭建/"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.js" defer></script><meta name="msvalidate.01" content="2A5F9D368A1824F4720641D00ED6EBAC"><meta name="baidu-site-verification" content="Y2QBEK0IzR"><meta name="360-site-verification" content="aa8403ee4495e5bbf6c5d012ce7c42c4"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"3HIY5YJKG3","apiKey":"31493f5412398fba8f6e1d0ec516ff3a","indexName":"my-blog","hits":{"per_page":6},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容:${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"简","msgToSimplifiedChinese":"繁"},
  highlight_copy: 'true',
  highlight_lang: 'true',
  highlight_shrink: 'false',
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: '添加书签',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  copyright: undefined,
  copy_copyright_js: false
  
}</script></head><body><canvas class="fireworks"></canvas><div id="header"> <div id="page-header"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">GZ's Blog</a></span><i class="fa fa-bars fa-fw toggle-menu pull-right close" aria-hidden="true"></i><span class="pull-right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa-fw fa fa-heartbeat" aria-hidden="true"></i><span> 清单</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li><li><a class="site-page" href="/books/"><i class="fa-fw fa fa-book"></i><span> 书籍</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fa fa-gamepad"></i><span> Game</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa-fw fa fa-coffee"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><script>document.body.addEventListener('touchstart', function(){ });</script></div></span><span class="pull-right" id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></span></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="lozad avatar_img" src="https://p.pstatp.com/origin/fe6a0000445b8c023898" onerror="onerror=null;src='/img/friend_404.gif'"></div><div class="mobile_post_data"><div class="mobile_data_item is_center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">24</div></a></div></div><div class="mobile_data_item is_center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">33</div></a></div></div><div class="mobile_data_item is_center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">39</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa-fw fa fa-heartbeat" aria-hidden="true"></i><span> 清单</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li><li><a class="site-page" href="/books/"><i class="fa-fw fa fa-book"></i><span> 书籍</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fa fa-gamepad"></i><span> Game</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa-fw fa fa-coffee"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><script>document.body.addEventListener('touchstart', function(){ });</script></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#docker介绍"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">docker介绍</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#什么是docker"><span class="toc_mobile_items-number">1.1.</span> <span class="toc_mobile_items-text">什么是docker</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#容器技术"><span class="toc_mobile_items-number">1.1.1.</span> <span class="toc_mobile_items-text">容器技术</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#使用最为广泛的开源容器引擎"><span class="toc_mobile_items-number">1.1.2.</span> <span class="toc_mobile_items-text">使用最为广泛的开源容器引擎</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#容器是一种操作系统级别的虚拟化技术"><span class="toc_mobile_items-number">1.1.3.</span> <span class="toc_mobile_items-text">容器是一种操作系统级别的虚拟化技术</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#依赖于Linux内核特性-Namespace-amp-Cgroups"><span class="toc_mobile_items-number">1.1.4.</span> <span class="toc_mobile_items-text">依赖于Linux内核特性 Namespace &amp; Cgroups</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#docker能给我们带来什么"><span class="toc_mobile_items-number">1.1.5.</span> <span class="toc_mobile_items-text">docker能给我们带来什么</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#docker使用场景"><span class="toc_mobile_items-number">1.1.6.</span> <span class="toc_mobile_items-text">docker使用场景</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Linux容器技术VS虚拟机"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text">Linux容器技术VS虚拟机</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Docker的基本组成"><span class="toc_mobile_items-number">3.</span> <span class="toc_mobile_items-text">Docker的基本组成</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#架构"><span class="toc_mobile_items-number">3.1.</span> <span class="toc_mobile_items-text">架构</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Docker-image-镜像"><span class="toc_mobile_items-number">3.2.</span> <span class="toc_mobile_items-text">Docker image 镜像</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Docker-Container-容器"><span class="toc_mobile_items-number">3.3.</span> <span class="toc_mobile_items-text">Docker Container 容器</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Docker-Registry-仓库"><span class="toc_mobile_items-number">3.4.</span> <span class="toc_mobile_items-text">Docker Registry 仓库</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#总结"><span class="toc_mobile_items-number">3.5.</span> <span class="toc_mobile_items-text">总结</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Docker容器相关技术简介"><span class="toc_mobile_items-number">4.</span> <span class="toc_mobile_items-text">Docker容器相关技术简介</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Docker依赖的Linux内核特性"><span class="toc_mobile_items-number">4.1.</span> <span class="toc_mobile_items-text">Docker依赖的Linux内核特性</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Docker容器的能力"><span class="toc_mobile_items-number">4.2.</span> <span class="toc_mobile_items-text">Docker容器的能力</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Docker的安装和配置"><span class="toc_mobile_items-number">5.</span> <span class="toc_mobile_items-text">Docker的安装和配置</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#配置docker源"><span class="toc_mobile_items-number">5.1.</span> <span class="toc_mobile_items-text">配置docker源</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#安装docker"><span class="toc_mobile_items-number">5.2.</span> <span class="toc_mobile_items-text">安装docker</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#启动docker服务"><span class="toc_mobile_items-number">5.3.</span> <span class="toc_mobile_items-text">启动docker服务</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#4-4配置阿里云镜像加速"><span class="toc_mobile_items-number">5.4.</span> <span class="toc_mobile_items-text">4.4配置阿里云镜像加速</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Docker的基本操作"><span class="toc_mobile_items-number">6.</span> <span class="toc_mobile_items-text">Docker的基本操作</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#启动容器"><span class="toc_mobile_items-number">6.1.</span> <span class="toc_mobile_items-text">启动容器</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#最基本的容器运行"><span class="toc_mobile_items-number">6.1.1.</span> <span class="toc_mobile_items-text">最基本的容器运行</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#交互式启动容器"><span class="toc_mobile_items-number">6.1.2.</span> <span class="toc_mobile_items-text">交互式启动容器</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#查看运行的容器"><span class="toc_mobile_items-number">6.2.</span> <span class="toc_mobile_items-text">查看运行的容器</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#查看详细的容器信息"><span class="toc_mobile_items-number">6.3.</span> <span class="toc_mobile_items-text">查看详细的容器信息</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#自定义容器的名字"><span class="toc_mobile_items-number">6.4.</span> <span class="toc_mobile_items-text">自定义容器的名字</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#重新启动已经停止的容器"><span class="toc_mobile_items-number">6.5.</span> <span class="toc_mobile_items-text">重新启动已经停止的容器</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#删除已经停止的容器"><span class="toc_mobile_items-number">6.6.</span> <span class="toc_mobile_items-text">删除已经停止的容器</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Docker守护式容器"><span class="toc_mobile_items-number">7.</span> <span class="toc_mobile_items-text">Docker守护式容器</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#什么是守护式容器？"><span class="toc_mobile_items-number">7.1.</span> <span class="toc_mobile_items-text">什么是守护式容器？</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#以守护形式运行容器"><span class="toc_mobile_items-number">7.2.</span> <span class="toc_mobile_items-text">以守护形式运行容器</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#启动守护式容器"><span class="toc_mobile_items-number">7.3.</span> <span class="toc_mobile_items-text">启动守护式容器</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#如何查看容器内部运行的情况呢？"><span class="toc_mobile_items-number">7.4.</span> <span class="toc_mobile_items-text">如何查看容器内部运行的情况呢？</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#查看容器内部的进程"><span class="toc_mobile_items-number">7.5.</span> <span class="toc_mobile_items-text">查看容器内部的进程</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#在已经运行的容器启动新的进程"><span class="toc_mobile_items-number">7.6.</span> <span class="toc_mobile_items-text">在已经运行的容器启动新的进程</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#停止守护式容器"><span class="toc_mobile_items-number">7.7.</span> <span class="toc_mobile_items-text">停止守护式容器</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#容器中部署静态网站"><span class="toc_mobile_items-number">8.</span> <span class="toc_mobile_items-text">容器中部署静态网站</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#启动Ubuntu容器"><span class="toc_mobile_items-number">8.1.</span> <span class="toc_mobile_items-text">启动Ubuntu容器</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#配置NGINX"><span class="toc_mobile_items-number">8.2.</span> <span class="toc_mobile_items-text">配置NGINX</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#浏览器查看"><span class="toc_mobile_items-number">8.3.</span> <span class="toc_mobile_items-text">浏览器查看</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#先查看端口映射"><span class="toc_mobile_items-number">8.3.1.</span> <span class="toc_mobile_items-text">先查看端口映射</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#访问测试"><span class="toc_mobile_items-number">8.3.2.</span> <span class="toc_mobile_items-text">访问测试</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#浏览器访问"><span class="toc_mobile_items-number">8.3.3.</span> <span class="toc_mobile_items-text">浏览器访问</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#端口映射的方式"><span class="toc_mobile_items-number">9.</span> <span class="toc_mobile_items-text">端口映射的方式</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#将容器所有公开的端口发布到宿主机随机端口"><span class="toc_mobile_items-number">9.1.</span> <span class="toc_mobile_items-text">将容器所有公开的端口发布到宿主机随机端口</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#指定映射容器的那些端口"><span class="toc_mobile_items-number">9.2.</span> <span class="toc_mobile_items-text">指定映射容器的那些端口</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#只指定容器的端口"><span class="toc_mobile_items-number">9.2.1.</span> <span class="toc_mobile_items-text">只指定容器的端口</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#指定宿主机和容器的端口"><span class="toc_mobile_items-number">9.2.2.</span> <span class="toc_mobile_items-text">指定宿主机和容器的端口</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#指定IP地址和宿主机、容器的端口"><span class="toc_mobile_items-number">9.2.3.</span> <span class="toc_mobile_items-text">指定IP地址和宿主机、容器的端口</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#指定IP地址和容器的端口"><span class="toc_mobile_items-number">9.2.4.</span> <span class="toc_mobile_items-text">指定IP地址和容器的端口</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#查看端口映射情况"><span class="toc_mobile_items-number">9.2.5.</span> <span class="toc_mobile_items-text">查看端口映射情况</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#查看和删除镜像"><span class="toc_mobile_items-number">10.</span> <span class="toc_mobile_items-text">查看和删除镜像</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#镜像存放的位置"><span class="toc_mobile_items-number">10.1.</span> <span class="toc_mobile_items-text">镜像存放的位置</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#列出镜像"><span class="toc_mobile_items-number">10.2.</span> <span class="toc_mobile_items-text">列出镜像</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#查看镜像的详细内容"><span class="toc_mobile_items-number">10.3.</span> <span class="toc_mobile_items-text">查看镜像的详细内容</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#删除镜像"><span class="toc_mobile_items-number">10.4.</span> <span class="toc_mobile_items-text">删除镜像</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#获取和推送镜像"><span class="toc_mobile_items-number">11.</span> <span class="toc_mobile_items-text">获取和推送镜像</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#搜索镜像"><span class="toc_mobile_items-number">11.1.</span> <span class="toc_mobile_items-text">搜索镜像</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#拉取镜像"><span class="toc_mobile_items-number">11.2.</span> <span class="toc_mobile_items-text">拉取镜像</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#推送镜像"><span class="toc_mobile_items-number">11.3.</span> <span class="toc_mobile_items-text">推送镜像</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#首先去docker-hub注册账号"><span class="toc_mobile_items-number">11.3.1.</span> <span class="toc_mobile_items-text">首先去docker hub注册账号</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#构建镜像"><span class="toc_mobile_items-number">12.</span> <span class="toc_mobile_items-text">构建镜像</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#什么是构建镜像？"><span class="toc_mobile_items-number">12.1.</span> <span class="toc_mobile_items-text">什么是构建镜像？</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#两种构建镜像的方式"><span class="toc_mobile_items-number">12.2.</span> <span class="toc_mobile_items-text">两种构建镜像的方式</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#通过容器构建"><span class="toc_mobile_items-number">12.2.1.</span> <span class="toc_mobile_items-text">通过容器构建</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#通过Dockerfile构建镜像"><span class="toc_mobile_items-number">12.3.</span> <span class="toc_mobile_items-text">通过Dockerfile构建镜像</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#什么是dockerfile？"><span class="toc_mobile_items-number">12.3.1.</span> <span class="toc_mobile_items-text">什么是dockerfile？</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#dockerfile的基本结构"><span class="toc_mobile_items-number">12.3.2.</span> <span class="toc_mobile_items-text">dockerfile的基本结构</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#dockerfile文件说明"><span class="toc_mobile_items-number">12.3.3.</span> <span class="toc_mobile_items-text">dockerfile文件说明</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#通过dockerfile构建nginx"><span class="toc_mobile_items-number">12.3.4.</span> <span class="toc_mobile_items-text">通过dockerfile构建nginx</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Docker远程连接"><span class="toc_mobile_items-number">13.</span> <span class="toc_mobile_items-text">Docker远程连接</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#docker的c-s模式"><span class="toc_mobile_items-number">13.1.</span> <span class="toc_mobile_items-text">docker的c/s模式</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#修改docker的启动脚本"><span class="toc_mobile_items-number">13.2.</span> <span class="toc_mobile_items-text">修改docker的启动脚本</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#重启docker"><span class="toc_mobile_items-number">13.3.</span> <span class="toc_mobile_items-text">重启docker</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#远程连接测试"><span class="toc_mobile_items-number">13.4.</span> <span class="toc_mobile_items-text">远程连接测试</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#浏览器测试"><span class="toc_mobile_items-number">13.4.1.</span> <span class="toc_mobile_items-text">浏览器测试</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#使用另一台机器测试"><span class="toc_mobile_items-number">13.4.2.</span> <span class="toc_mobile_items-text">使用另一台机器测试</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Docker的基础网络类型"><span class="toc_mobile_items-number">14.</span> <span class="toc_mobile_items-text">Docker的基础网络类型</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#docker的四种网络类型"><span class="toc_mobile_items-number">14.1.</span> <span class="toc_mobile_items-text">docker的四种网络类型</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Bridge桥接模式"><span class="toc_mobile_items-number">14.2.</span> <span class="toc_mobile_items-text">Bridge桥接模式</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#启动两个容器"><span class="toc_mobile_items-number">14.2.1.</span> <span class="toc_mobile_items-text">启动两个容器</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#容器间能互相ping通"><span class="toc_mobile_items-number">14.2.2.</span> <span class="toc_mobile_items-text">容器间能互相ping通</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Host网络模式"><span class="toc_mobile_items-number">14.3.</span> <span class="toc_mobile_items-text">Host网络模式</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#使用host网络模式启动容器"><span class="toc_mobile_items-number">14.3.1.</span> <span class="toc_mobile_items-text">使用host网络模式启动容器</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Container网络模式"><span class="toc_mobile_items-number">14.4.</span> <span class="toc_mobile_items-text">Container网络模式</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#None网络模式"><span class="toc_mobile_items-number">14.5.</span> <span class="toc_mobile_items-text">None网络模式</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Docker的数据卷"><span class="toc_mobile_items-number">15.</span> <span class="toc_mobile_items-text">Docker的数据卷</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#什么是数据卷？"><span class="toc_mobile_items-number">15.1.</span> <span class="toc_mobile_items-text">什么是数据卷？</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#关于UFS文件系统"><span class="toc_mobile_items-number">15.2.</span> <span class="toc_mobile_items-text">关于UFS文件系统</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#数据卷的设计目的"><span class="toc_mobile_items-number">15.3.</span> <span class="toc_mobile_items-text">数据卷的设计目的</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#为容器添加数据卷"><span class="toc_mobile_items-number">15.4.</span> <span class="toc_mobile_items-text">为容器添加数据卷</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#数据卷的权限设置"><span class="toc_mobile_items-number">15.5.</span> <span class="toc_mobile_items-text">数据卷的权限设置</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Docker的数据卷容器"><span class="toc_mobile_items-number">16.</span> <span class="toc_mobile_items-text">Docker的数据卷容器</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#制作数据卷容器"><span class="toc_mobile_items-number">16.1.</span> <span class="toc_mobile_items-text">制作数据卷容器</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#启动数据卷容器"><span class="toc_mobile_items-number">16.2.</span> <span class="toc_mobile_items-text">启动数据卷容器</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#容器连接数据卷容器"><span class="toc_mobile_items-number">16.3.</span> <span class="toc_mobile_items-text">容器连接数据卷容器</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#数据卷的备份和还原"><span class="toc_mobile_items-number">17.</span> <span class="toc_mobile_items-text">数据卷的备份和还原</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#数据卷备份操作原理图"><span class="toc_mobile_items-number">17.1.</span> <span class="toc_mobile_items-text">数据卷备份操作原理图</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#数据卷还原"><span class="toc_mobile_items-number">17.2.</span> <span class="toc_mobile_items-text">数据卷还原</span></a></li></ol></li></ol></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#docker介绍"><span class="toc-number">1.</span> <span class="toc-text">docker介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#什么是docker"><span class="toc-number">1.1.</span> <span class="toc-text">什么是docker</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#容器技术"><span class="toc-number">1.1.1.</span> <span class="toc-text">容器技术</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#使用最为广泛的开源容器引擎"><span class="toc-number">1.1.2.</span> <span class="toc-text">使用最为广泛的开源容器引擎</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#容器是一种操作系统级别的虚拟化技术"><span class="toc-number">1.1.3.</span> <span class="toc-text">容器是一种操作系统级别的虚拟化技术</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#依赖于Linux内核特性-Namespace-amp-Cgroups"><span class="toc-number">1.1.4.</span> <span class="toc-text">依赖于Linux内核特性 Namespace &amp; Cgroups</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#docker能给我们带来什么"><span class="toc-number">1.1.5.</span> <span class="toc-text">docker能给我们带来什么</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#docker使用场景"><span class="toc-number">1.1.6.</span> <span class="toc-text">docker使用场景</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Linux容器技术VS虚拟机"><span class="toc-number">2.</span> <span class="toc-text">Linux容器技术VS虚拟机</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker的基本组成"><span class="toc-number">3.</span> <span class="toc-text">Docker的基本组成</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#架构"><span class="toc-number">3.1.</span> <span class="toc-text">架构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Docker-image-镜像"><span class="toc-number">3.2.</span> <span class="toc-text">Docker image 镜像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Docker-Container-容器"><span class="toc-number">3.3.</span> <span class="toc-text">Docker Container 容器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Docker-Registry-仓库"><span class="toc-number">3.4.</span> <span class="toc-text">Docker Registry 仓库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#总结"><span class="toc-number">3.5.</span> <span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker容器相关技术简介"><span class="toc-number">4.</span> <span class="toc-text">Docker容器相关技术简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Docker依赖的Linux内核特性"><span class="toc-number">4.1.</span> <span class="toc-text">Docker依赖的Linux内核特性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Docker容器的能力"><span class="toc-number">4.2.</span> <span class="toc-text">Docker容器的能力</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker的安装和配置"><span class="toc-number">5.</span> <span class="toc-text">Docker的安装和配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#配置docker源"><span class="toc-number">5.1.</span> <span class="toc-text">配置docker源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#安装docker"><span class="toc-number">5.2.</span> <span class="toc-text">安装docker</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#启动docker服务"><span class="toc-number">5.3.</span> <span class="toc-text">启动docker服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4配置阿里云镜像加速"><span class="toc-number">5.4.</span> <span class="toc-text">4.4配置阿里云镜像加速</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker的基本操作"><span class="toc-number">6.</span> <span class="toc-text">Docker的基本操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#启动容器"><span class="toc-number">6.1.</span> <span class="toc-text">启动容器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#最基本的容器运行"><span class="toc-number">6.1.1.</span> <span class="toc-text">最基本的容器运行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#交互式启动容器"><span class="toc-number">6.1.2.</span> <span class="toc-text">交互式启动容器</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查看运行的容器"><span class="toc-number">6.2.</span> <span class="toc-text">查看运行的容器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查看详细的容器信息"><span class="toc-number">6.3.</span> <span class="toc-text">查看详细的容器信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#自定义容器的名字"><span class="toc-number">6.4.</span> <span class="toc-text">自定义容器的名字</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#重新启动已经停止的容器"><span class="toc-number">6.5.</span> <span class="toc-text">重新启动已经停止的容器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#删除已经停止的容器"><span class="toc-number">6.6.</span> <span class="toc-text">删除已经停止的容器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker守护式容器"><span class="toc-number">7.</span> <span class="toc-text">Docker守护式容器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#什么是守护式容器？"><span class="toc-number">7.1.</span> <span class="toc-text">什么是守护式容器？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#以守护形式运行容器"><span class="toc-number">7.2.</span> <span class="toc-text">以守护形式运行容器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#启动守护式容器"><span class="toc-number">7.3.</span> <span class="toc-text">启动守护式容器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#如何查看容器内部运行的情况呢？"><span class="toc-number">7.4.</span> <span class="toc-text">如何查看容器内部运行的情况呢？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查看容器内部的进程"><span class="toc-number">7.5.</span> <span class="toc-text">查看容器内部的进程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#在已经运行的容器启动新的进程"><span class="toc-number">7.6.</span> <span class="toc-text">在已经运行的容器启动新的进程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#停止守护式容器"><span class="toc-number">7.7.</span> <span class="toc-text">停止守护式容器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#容器中部署静态网站"><span class="toc-number">8.</span> <span class="toc-text">容器中部署静态网站</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#启动Ubuntu容器"><span class="toc-number">8.1.</span> <span class="toc-text">启动Ubuntu容器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#配置NGINX"><span class="toc-number">8.2.</span> <span class="toc-text">配置NGINX</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#浏览器查看"><span class="toc-number">8.3.</span> <span class="toc-text">浏览器查看</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#先查看端口映射"><span class="toc-number">8.3.1.</span> <span class="toc-text">先查看端口映射</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#访问测试"><span class="toc-number">8.3.2.</span> <span class="toc-text">访问测试</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#浏览器访问"><span class="toc-number">8.3.3.</span> <span class="toc-text">浏览器访问</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#端口映射的方式"><span class="toc-number">9.</span> <span class="toc-text">端口映射的方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#将容器所有公开的端口发布到宿主机随机端口"><span class="toc-number">9.1.</span> <span class="toc-text">将容器所有公开的端口发布到宿主机随机端口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#指定映射容器的那些端口"><span class="toc-number">9.2.</span> <span class="toc-text">指定映射容器的那些端口</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#只指定容器的端口"><span class="toc-number">9.2.1.</span> <span class="toc-text">只指定容器的端口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#指定宿主机和容器的端口"><span class="toc-number">9.2.2.</span> <span class="toc-text">指定宿主机和容器的端口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#指定IP地址和宿主机、容器的端口"><span class="toc-number">9.2.3.</span> <span class="toc-text">指定IP地址和宿主机、容器的端口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#指定IP地址和容器的端口"><span class="toc-number">9.2.4.</span> <span class="toc-text">指定IP地址和容器的端口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#查看端口映射情况"><span class="toc-number">9.2.5.</span> <span class="toc-text">查看端口映射情况</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#查看和删除镜像"><span class="toc-number">10.</span> <span class="toc-text">查看和删除镜像</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#镜像存放的位置"><span class="toc-number">10.1.</span> <span class="toc-text">镜像存放的位置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#列出镜像"><span class="toc-number">10.2.</span> <span class="toc-text">列出镜像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查看镜像的详细内容"><span class="toc-number">10.3.</span> <span class="toc-text">查看镜像的详细内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#删除镜像"><span class="toc-number">10.4.</span> <span class="toc-text">删除镜像</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#获取和推送镜像"><span class="toc-number">11.</span> <span class="toc-text">获取和推送镜像</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#搜索镜像"><span class="toc-number">11.1.</span> <span class="toc-text">搜索镜像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#拉取镜像"><span class="toc-number">11.2.</span> <span class="toc-text">拉取镜像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#推送镜像"><span class="toc-number">11.3.</span> <span class="toc-text">推送镜像</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#首先去docker-hub注册账号"><span class="toc-number">11.3.1.</span> <span class="toc-text">首先去docker hub注册账号</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#构建镜像"><span class="toc-number">12.</span> <span class="toc-text">构建镜像</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#什么是构建镜像？"><span class="toc-number">12.1.</span> <span class="toc-text">什么是构建镜像？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#两种构建镜像的方式"><span class="toc-number">12.2.</span> <span class="toc-text">两种构建镜像的方式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#通过容器构建"><span class="toc-number">12.2.1.</span> <span class="toc-text">通过容器构建</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#通过Dockerfile构建镜像"><span class="toc-number">12.3.</span> <span class="toc-text">通过Dockerfile构建镜像</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#什么是dockerfile？"><span class="toc-number">12.3.1.</span> <span class="toc-text">什么是dockerfile？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#dockerfile的基本结构"><span class="toc-number">12.3.2.</span> <span class="toc-text">dockerfile的基本结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#dockerfile文件说明"><span class="toc-number">12.3.3.</span> <span class="toc-text">dockerfile文件说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#通过dockerfile构建nginx"><span class="toc-number">12.3.4.</span> <span class="toc-text">通过dockerfile构建nginx</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker远程连接"><span class="toc-number">13.</span> <span class="toc-text">Docker远程连接</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#docker的c-s模式"><span class="toc-number">13.1.</span> <span class="toc-text">docker的c/s模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修改docker的启动脚本"><span class="toc-number">13.2.</span> <span class="toc-text">修改docker的启动脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#重启docker"><span class="toc-number">13.3.</span> <span class="toc-text">重启docker</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#远程连接测试"><span class="toc-number">13.4.</span> <span class="toc-text">远程连接测试</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#浏览器测试"><span class="toc-number">13.4.1.</span> <span class="toc-text">浏览器测试</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#使用另一台机器测试"><span class="toc-number">13.4.2.</span> <span class="toc-text">使用另一台机器测试</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker的基础网络类型"><span class="toc-number">14.</span> <span class="toc-text">Docker的基础网络类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#docker的四种网络类型"><span class="toc-number">14.1.</span> <span class="toc-text">docker的四种网络类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Bridge桥接模式"><span class="toc-number">14.2.</span> <span class="toc-text">Bridge桥接模式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#启动两个容器"><span class="toc-number">14.2.1.</span> <span class="toc-text">启动两个容器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#容器间能互相ping通"><span class="toc-number">14.2.2.</span> <span class="toc-text">容器间能互相ping通</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Host网络模式"><span class="toc-number">14.3.</span> <span class="toc-text">Host网络模式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#使用host网络模式启动容器"><span class="toc-number">14.3.1.</span> <span class="toc-text">使用host网络模式启动容器</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Container网络模式"><span class="toc-number">14.4.</span> <span class="toc-text">Container网络模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#None网络模式"><span class="toc-number">14.5.</span> <span class="toc-text">None网络模式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker的数据卷"><span class="toc-number">15.</span> <span class="toc-text">Docker的数据卷</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#什么是数据卷？"><span class="toc-number">15.1.</span> <span class="toc-text">什么是数据卷？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#关于UFS文件系统"><span class="toc-number">15.2.</span> <span class="toc-text">关于UFS文件系统</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据卷的设计目的"><span class="toc-number">15.3.</span> <span class="toc-text">数据卷的设计目的</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#为容器添加数据卷"><span class="toc-number">15.4.</span> <span class="toc-text">为容器添加数据卷</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据卷的权限设置"><span class="toc-number">15.5.</span> <span class="toc-text">数据卷的权限设置</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker的数据卷容器"><span class="toc-number">16.</span> <span class="toc-text">Docker的数据卷容器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#制作数据卷容器"><span class="toc-number">16.1.</span> <span class="toc-text">制作数据卷容器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#启动数据卷容器"><span class="toc-number">16.2.</span> <span class="toc-text">启动数据卷容器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#容器连接数据卷容器"><span class="toc-number">16.3.</span> <span class="toc-text">容器连接数据卷容器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据卷的备份和还原"><span class="toc-number">17.</span> <span class="toc-text">数据卷的备份和还原</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#数据卷备份操作原理图"><span class="toc-number">17.1.</span> <span class="toc-text">数据卷备份操作原理图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据卷还原"><span class="toc-number">17.2.</span> <span class="toc-text">数据卷还原</span></a></li></ol></li></ol></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://puui.qpic.cn/fans_admin/0/3_902214536_1573730288351/0)"><div id="post-info"><div id="post-title"><div class="posttitle">容器化技术--Docker</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2019-11-14<span class="post-meta__separator">|</span><i class="fa fa-history" aria-hidden="true"></i> 更新于 2019-11-14</time><span class="post-meta__separator mobile_hidden">|</span><span class="mobile_hidden"><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Linux/">Linux</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Linux/容器化技术/">容器化技术</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Linux/容器化技术/Docker/">Docker</a></span><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">11.4k</span><span class="post-meta__separator">|</span><span>阅读时长: 53 分钟</span><span class="post-meta__separator">|</span><span>阅读量: </span><span id="busuanzi_value_page_pv"></span></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><p><img alt data-src="https://puui.qpic.cn/fans_admin/0/3_902214536_1573730288351/0" class="lozad"></p>
<h2 id="docker介绍"><a href="#docker介绍" class="headerlink" title="docker介绍"></a>docker介绍</h2><h3 id="什么是docker"><a href="#什么是docker" class="headerlink" title="什么是docker"></a>什么是docker</h3><h4 id="容器技术"><a href="#容器技术" class="headerlink" title="容器技术"></a>容器技术</h4><p>想要了解docker，首先要知道什么是容器。最早的容器技术来自于BSD的jail技术(jail一词是监狱的意思，这个技术的隔离思想来源于监狱的启发)，目的就是为了实现进程隔离，使得一个进程被攻陷后不会影响到其他进程，这是出于安全的目的。</p>
<h4 id="使用最为广泛的开源容器引擎"><a href="#使用最为广泛的开源容器引擎" class="headerlink" title="使用最为广泛的开源容器引擎"></a>使用最为广泛的开源容器引擎</h4><p>在近几年来，docker是一个非常火的名词。事实上docker只是众多容器引擎其中一款优秀的容器引擎，但是它却几乎成为了容器的代名词。许多业外人士觉得docker就是容器，这里大家要明白，docker只是属于容器技术的一种</p>
<h4 id="容器是一种操作系统级别的虚拟化技术"><a href="#容器是一种操作系统级别的虚拟化技术" class="headerlink" title="容器是一种操作系统级别的虚拟化技术"></a>容器是一种操作系统级别的虚拟化技术</h4><p>使用docker创建的容器，以特殊进程的方式在宿主机上运行，运行一个容器就像运行一个进程一样，宿主机上可以运行多个容器，容器间是互相隔离的</p>
<h4 id="依赖于Linux内核特性-Namespace-amp-Cgroups"><a href="#依赖于Linux内核特性-Namespace-amp-Cgroups" class="headerlink" title="依赖于Linux内核特性 Namespace &amp; Cgroups"></a>依赖于Linux内核特性 Namespace &amp; Cgroups</h4><p>容器运行的是一个隔离的环境，也可以理解类似于一个沙盒，使用Namespace进行资源的隔离，使用Cgroups进行资源的控制</p>
<h4 id="docker能给我们带来什么"><a href="#docker能给我们带来什么" class="headerlink" title="docker能给我们带来什么"></a>docker能给我们带来什么</h4><ol>
<li>提供简单轻量的建模方式，非常容易上手，运行速度非常快</li>
<li>使开发和运维的职责分离，开发只需要关心容器中的程序，运维只需要管理容器</li>
<li>快速高效的开发生命周期，开发环境和生产环境一致，避免了额外的调试有效缩短上线时间</li>
<li>鼓励使用面向服务的架构，docker推荐单个容器只运行一个应用程序，使分布式扩展和调试变得简单</li>
</ol>
<h4 id="docker使用场景"><a href="#docker使用场景" class="headerlink" title="docker使用场景"></a>docker使用场景</h4><ol>
<li>使用docker容器开发、测试、部署服务</li>
<li>创建隔离的运行环境</li>
<li>搭建测试环境</li>
<li>构建多用户的平台即服务基层设施</li>
<li>提供软件即服务应用程序</li>
<li>高性能、超大规模的宿主机部署</li>
</ol>
<h2 id="Linux容器技术VS虚拟机"><a href="#Linux容器技术VS虚拟机" class="headerlink" title="Linux容器技术VS虚拟机"></a>Linux容器技术VS虚拟机</h2><p><img alt data-src="https://puui.qpic.cn/fans_admin/0/3_1206436828_1573729334873/0" class="lozad"></p>
<p>大家可以显而易见的看到，使用虚拟机部署应用，不但包含应用和应用依赖的库文件，还包含完整的操作系统，原本可能只需要几十M的应用，却需要动辄几个G的操作系统来支撑。而再看容器的这个图，部署应用只需要应用和应用依赖的库文件，这样资源占用大大减少。另外，虚拟机还需要虚拟硬件，对CPU和内存的损耗非常大。所以同样配置的服务器，使用容器技术要比使用虚拟机，能够提供更多的服务能力，服更多的用户。</p>
<p>虽然容器技术在最近几年才火起来，但容器技术却不是一个新兴的技术。那为什么直到docker的出现，容器技术才真正被大家关注起来呢？因为容器技术本身的复杂性，而且依赖于Linux内核的特性，不易于安装，也不容易管理和实现自动化。然而docker就是为了改变这一切而出现的，docker的出现也让容器技术产生了革命性的改变。</p>
<h2 id="Docker的基本组成"><a href="#Docker的基本组成" class="headerlink" title="Docker的基本组成"></a>Docker的基本组成</h2><h3 id="架构"><a href="#架构" class="headerlink" title="架构"></a>架构</h3><p><img alt data-src="https://puui.qpic.cn/fans_admin/0/3_1206436828_1573729410776/0" class="lozad"></p>
<p>Docker是基于C/S架构的程序，docker的客户端向服务端（也称守护进程）发出请求，守护进程执行的结果会返回到客户端。客户端和守护进程的通信，可以是在本地，也可以通过远程的方式进行。</p>
<h3 id="Docker-image-镜像"><a href="#Docker-image-镜像" class="headerlink" title="Docker image 镜像"></a>Docker image 镜像</h3><p><img alt data-src="https://puui.qpic.cn/fans_admin/0/3_1452557490_1573729464823/0" class="lozad"></p>
<p>容器的基石，包含了容器启动的一切条件，容器基于镜像去启动</p>
<p>镜像是层叠的只读文件系统，底层是bootfs引导文件系统，rootfs文件系统永远是只读状态（保证镜像无论启动多少个容器，或者容器被如何修改，都不会改变镜像，使镜像和容器分离）。一个镜像可以放到一个镜像的顶部，最下面的镜像称为基础镜像，就是图中的Ubuntu层。这里利用了COW（copy on write）技术，即从一个镜像启动一个容器实例，这个镜像是以只读形式挂载的，即不允许任何修改操作。当在容器实例中修改一个文件时，会首先从镜像里把这个文件拷贝到可写层，然后执行更新操作。</p>
<h3 id="Docker-Container-容器"><a href="#Docker-Container-容器" class="headerlink" title="Docker Container 容器"></a>Docker Container 容器</h3><p>通过镜像启动</p>
<p>守护进程执行命令就是在容器中执行</p>
<p>应用部署在容器中</p>
<p>在启动容器时，会在镜像的最上层创建一个读写层，在加上下面的只读层，从而构成一个容器</p>
<h3 id="Docker-Registry-仓库"><a href="#Docker-Registry-仓库" class="headerlink" title="Docker Registry 仓库"></a>Docker Registry 仓库</h3><p>仓库里面保存着用户构建的镜像</p>
<p>分为公有仓库（docker公司的仓库）和私有仓库（公司内部使用）</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p><img alt data-src="https://puui.qpic.cn/fans_admin/0/3_1206436828_1573729536707/0" class="lozad"></p>
<p>Docker 客户端发送命令给守护进程，守护进程去仓库寻找镜像，如果仓库存在相应镜像，就会通过镜像去启动容器执行相应的操作，如果仓库不存在相应的镜像，就会先把镜像pull到本地镜像仓库。对容器做修改，不会改变镜像的内容。修改后的容器，可以进行提交成为一个新的镜像，它是基于上一个镜像的修改得到的，那上一个镜像就是它的父镜像，镜像的关系可以是层叠的。仓库的作用是保存镜像同时对镜像进行分类。容器相当于一个独立的系统，进入一个基于centos镜像启动的容器就类似进入一个Linux系统，它拥有自己的进程、文件系统、网络等，但却没有自己的内核，通过调用宿主机的内核进行工作。</p>
<h2 id="Docker容器相关技术简介"><a href="#Docker容器相关技术简介" class="headerlink" title="Docker容器相关技术简介"></a>Docker容器相关技术简介</h2><h3 id="Docker依赖的Linux内核特性"><a href="#Docker依赖的Linux内核特性" class="headerlink" title="Docker依赖的Linux内核特性"></a>Docker依赖的Linux内核特性</h3><p>Namespaces 命令空间</p>
<p>在编程语言中，一般指定是封装代码，实现代码隔离</p>
<p>在操作系统中，是指系统资源的隔离，例如进程、网络、文件系统等…这也是容器所依赖的Linux特性，一个容器中的进程，可以感知容器内其他进程的变化，而对其他容器内的进程一无所知，这就使容器产生一种错觉，仿佛自己置身于独立的操作系统中。</p>
<ol>
<li>PID—进程隔离</li>
<li>NET—管理网络接口</li>
<li>IPC—管理跨进程通信的访问</li>
<li>MNT—管理挂载点</li>
<li>UTS—隔离内核和版本标识</li>
</ol>
<p>Control Groups 控制组</p>
<ol>
<li>用来分配资源<ol>
<li>资源限制</li>
<li>优先级设定</li>
<li>资源计量</li>
<li>资源控制</li>
</ol>
</li>
<li>来源于Google</li>
<li>Linux kernel 2.6.24@2007</li>
<li>为了容器而生，没有Cgroups技术就没有今天的容器技术</li>
</ol>
<h3 id="Docker容器的能力"><a href="#Docker容器的能力" class="headerlink" title="Docker容器的能力"></a>Docker容器的能力</h3><ol>
<li>文件系统隔离：每个容器都有自己的root文件系统</li>
<li>进程隔离：每个容器都运行在自己的进程环境中</li>
<li>网络隔离：容器间的虚拟网络接口和IP地址都是分开的</li>
<li>资源隔离和分组：使用cgroup将CPU和内存等资源独立分配给每一个容器</li>
</ol>
<h2 id="Docker的安装和配置"><a href="#Docker的安装和配置" class="headerlink" title="Docker的安装和配置"></a>Docker的安装和配置</h2><h3 id="配置docker源"><a href="#配置docker源" class="headerlink" title="配置docker源"></a>配置docker源</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl  http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo -o /etc/yum.repos.d/docker-ce.repo</span><br><span class="line">wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo</span><br><span class="line">curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo</span><br></pre></td></tr></table></figure>

<h3 id="安装docker"><a href="#安装docker" class="headerlink" title="安装docker"></a>安装docker</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># yum install -y yum-utils device-mapper-persistent-data lvm2		#依赖包</span></span><br><span class="line">[root@docker ~]<span class="comment"># yum install -y --setopt=obsoletes=0 \</span></span><br><span class="line">&gt; docker-ce-17.03.2.ce-1.el7.centos.x86_64 \		<span class="comment">#主程序是这个包</span></span><br><span class="line">&gt; docker-ce-selinux-17.03.2.ce-1.el7.centos.noarch</span><br></pre></td></tr></table></figure>

<h3 id="启动docker服务"><a href="#启动docker服务" class="headerlink" title="启动docker服务"></a>启动docker服务</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># systemctl daemon-reload	#重新加载systemd程序的配置文件，docker的启动脚本在/usr/lib/systemd/system/docker.service</span></span><br><span class="line">[root@docker ~]<span class="comment"># systemctl restart docker</span></span><br><span class="line">[root@docker ~]<span class="comment"># docker version		#能看到server的信息说明启动成功</span></span><br><span class="line">Client:</span><br><span class="line"> Version:      17.03.2-ce</span><br><span class="line"> API version:  1.27</span><br><span class="line"> Go version:   go1.7.5</span><br><span class="line"> Git commit:   f5ec1e2</span><br><span class="line"> Built:        Tue Jun 27 02:21:36 2017</span><br><span class="line"> OS/Arch:      linux/amd64</span><br><span class="line"></span><br><span class="line">Server:</span><br><span class="line"> Version:      17.03.2-ce</span><br><span class="line"> API version:  1.27 (minimum version 1.12)</span><br><span class="line"> Go version:   go1.7.5</span><br><span class="line"> Git commit:   f5ec1e2</span><br><span class="line"> Built:        Tue Jun 27 02:21:36 2017</span><br><span class="line"> OS/Arch:      linux/amd64</span><br><span class="line"> Experimental: <span class="literal">false</span></span><br><span class="line">[root@docker system]<span class="comment"># docker info		#能看到信息说明启动成功</span></span><br><span class="line">Containers: 0</span><br><span class="line"> Running: 0</span><br><span class="line"> Paused: 0</span><br><span class="line"> Stopped: 0</span><br><span class="line">Images: 0</span><br><span class="line">Server Version: 17.03.2-ce</span><br><span class="line">Storage Driver: overlay</span><br><span class="line"> Backing Filesystem: extfs</span><br><span class="line"> Supports d_type: <span class="literal">true</span></span><br><span class="line">Logging Driver: json-file</span><br><span class="line">Cgroup Driver: cgroupfs</span><br><span class="line">Plugins: </span><br><span class="line"> Volume: <span class="built_in">local</span></span><br><span class="line"> Network: bridge host macvlan null overlay</span><br><span class="line">Swarm: inactive</span><br><span class="line">Runtimes: runc</span><br><span class="line">Default Runtime: runc</span><br><span class="line">Init Binary: docker-init</span><br><span class="line">containerd version: 4ab9917febca54791c5f071a9d1f404867857fcc</span><br><span class="line">runc version: 54296cf40ad8143b62dbcaa1d90e520a2136ddfe</span><br><span class="line">init version: 949e6fa</span><br><span class="line">Security Options:</span><br><span class="line"> seccomp</span><br><span class="line">  Profile: default</span><br><span class="line">Kernel Version: 3.10.0-957.el7.x86_64</span><br><span class="line">Operating System: CentOS Linux 7 (Core)</span><br><span class="line">OSType: linux</span><br><span class="line">Architecture: x86_64</span><br><span class="line">CPUs: 1</span><br><span class="line">Total Memory: 972.6 MiB</span><br><span class="line">Name: docker</span><br><span class="line">ID: 7C2X:HUGL:C67Z:ULWH:3722:BFJM:Q2C3:M4SB:MERP:JNPC:XVZU:V3KB</span><br><span class="line">Docker Root Dir: /var/lib/docker</span><br><span class="line">Debug Mode (client): <span class="literal">false</span></span><br><span class="line">Debug Mode (server): <span class="literal">false</span></span><br><span class="line">Registry: https://index.docker.io/v1/</span><br><span class="line">Experimental: <span class="literal">false</span></span><br><span class="line">Insecure Registries:</span><br><span class="line"> 127.0.0.0/8</span><br><span class="line">Live Restore Enabled: <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">WARNING: bridge-nf-call-iptables is disabled</span><br><span class="line">WARNING: bridge-nf-call-ip6tables is disabled</span><br><span class="line">[root@docker system]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="4-4配置阿里云镜像加速"><a href="#4-4配置阿里云镜像加速" class="headerlink" title="4.4配置阿里云镜像加速"></a>4.4配置阿里云镜像加速</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># cat /etc/docker/daemon.json	#不配置国内的docker源，下载速度非常慢</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"registry-mirrors"</span>: [<span class="string">"https://265wemgl.mirror.aliyuncs.com"</span>]</span><br><span class="line">&#125;</span><br><span class="line">[root@docker ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="Docker的基本操作"><a href="#Docker的基本操作" class="headerlink" title="Docker的基本操作"></a>Docker的基本操作</h2><h3 id="启动容器"><a href="#启动容器" class="headerlink" title="启动容器"></a>启动容器</h3><h4 id="最基本的容器运行"><a href="#最基本的容器运行" class="headerlink" title="最基本的容器运行"></a>最基本的容器运行</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker run ubuntu cat /etc/lsb-release		#启动一个Ubuntu的容器执行一条命令后退出容器，可以使用镜像名或者镜像ID启动</span></span><br><span class="line">DISTRIB_ID=Ubuntu</span><br><span class="line">DISTRIB_RELEASE=18.04</span><br><span class="line">DISTRIB_CODENAME=bionic</span><br><span class="line">DISTRIB_DESCRIPTION=<span class="string">"Ubuntu 18.04.2 LTS"</span></span><br><span class="line">[root@docker ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h4 id="交互式启动容器"><a href="#交互式启动容器" class="headerlink" title="交互式启动容器"></a>交互式启动容器</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker container run -it ubuntu /bin/bash</span></span><br><span class="line">root@febf164ed233:/<span class="comment"># ps -ef</span></span><br><span class="line">UID         PID   PPID  C STIME TTY          TIME CMD</span><br><span class="line">root          1      0  0 01:23 ?        00:00:00 /bin/bash</span><br><span class="line">root          9      1  0 01:23 ?        00:00:00 ps -ef</span><br><span class="line">root@febf164ed233:/<span class="comment">#</span></span><br><span class="line">-i 为容器始终打开标准输入</span><br><span class="line">-t	为容器分配一个伪tty终端</span><br><span class="line">-/bin/bash 启动一个bash</span><br></pre></td></tr></table></figure>

<h3 id="查看运行的容器"><a href="#查看运行的容器" class="headerlink" title="查看运行的容器"></a>查看运行的容器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker ps -a	#不加-a参数只会显示正在运行中的容器</span></span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                      PORTS               NAMES</span><br><span class="line">67481376c1db        ubuntu              <span class="string">"/bin/bash"</span>              11 seconds ago      Exited (0) 8 seconds ago                        unruffled_mahavira</span><br><span class="line">a0de49b1f37b        ubuntu              <span class="string">"cat /etc/lsb-release"</span>   19 seconds ago      Exited (0) 18 seconds ago                       sleepy_wozniak</span><br><span class="line">[root@docker ~]<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[root@docker ~]<span class="comment"># docker container ls -a		#docker新版本查看方法</span></span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                     PORTS               NAMES</span><br><span class="line">67481376c1db        ubuntu              <span class="string">"/bin/bash"</span>              2 minutes ago       Exited (0) 2 minutes ago                       unruffled_mahavira</span><br><span class="line">a0de49b1f37b        ubuntu              <span class="string">"cat /etc/lsb-release"</span>   2 minutes ago       Exited (0) 2 minutes ago                       sleepy_wozniak</span><br><span class="line">[root@docker ~]<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[root@docker ~]<span class="comment"># docker container ls -a -q	#加-q参数会只显示容器的ID</span></span><br><span class="line">67481376c1db</span><br><span class="line">a0de49b1f37b</span><br><span class="line">[root@docker ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="查看详细的容器信息"><a href="#查看详细的容器信息" class="headerlink" title="查看详细的容器信息"></a>查看详细的容器信息</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker inspect 67481376c1db		#可以是容器的名字可以是容器的ID</span></span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">"Id"</span>: <span class="string">"67481376c1dbd16f2cdb45f95dbc89758df1ae267289f96aca286242dab36578"</span>,</span><br><span class="line">        <span class="string">"Created"</span>: <span class="string">"2019-07-31T03:15:25.938873941Z"</span>,</span><br><span class="line">        <span class="string">"Path"</span>: <span class="string">"/bin/bash"</span>,</span><br><span class="line">        <span class="string">"Args"</span>: [],</span><br><span class="line">        <span class="string">"State"</span>: &#123;</span><br><span class="line">            <span class="string">"Status"</span>: <span class="string">"exited"</span>,</span><br><span class="line">            <span class="string">"Running"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">"Paused"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">"Restarting"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">"OOMKilled"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">"Dead"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">"Pid"</span>: 0,</span><br><span class="line">            <span class="string">"ExitCode"</span>: 0,</span><br><span class="line">            <span class="string">"Error"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"StartedAt"</span>: <span class="string">"2019-07-31T03:15:26.09471362Z"</span>,</span><br><span class="line">            <span class="string">"FinishedAt"</span>: <span class="string">"2019-07-31T03:15:27.970398517Z"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"Image"</span>: <span class="string">"sha256:3556258649b2ef23a41812be17377d32f568ed9f45150a26466d2ea26d926c32"</span>,</span><br><span class="line">        <span class="string">"ResolvConfPath"</span>: <span class="string">"/var/lib/docker/containers/67481376c1dbd16f2cdb45f95dbc89758df1ae267289f96aca286242dab36578/resolv.conf"</span>,</span><br><span class="line">        <span class="string">"HostnamePath"</span>: <span class="string">"/var/lib/docker/containers/67481376c1dbd16f2cdb45f95dbc89758df1ae267289f96aca286242dab36578/hostname"</span>,</span><br><span class="line">        <span class="string">"HostsPath"</span>: <span class="string">"/var/lib/docker/containers/67481376c1dbd16f2cdb45f95dbc89758df1ae267289f96aca286242dab36578/hosts"</span>,</span><br><span class="line">        <span class="string">"LogPath"</span>: <span class="string">"/var/lib/docker/containers/67481376c1dbd16f2cdb45f95dbc89758df1ae267289f96aca286242dab36578/67481376c1dbd16f2cdb45f95dbc89758df1ae267289f96aca286242dab3</span></span><br><span class="line"><span class="string">6578-json.log"</span>,        <span class="string">"Name"</span>: <span class="string">"/unruffled_mahavira"</span>,</span><br><span class="line">        <span class="string">"RestartCount"</span>: 0,</span><br><span class="line">        <span class="string">"Driver"</span>: <span class="string">"overlay"</span>,</span><br><span class="line">        <span class="string">"MountLabel"</span>: <span class="string">""</span>,</span><br><span class="line">        <span class="string">"ProcessLabel"</span>: <span class="string">""</span>,</span><br><span class="line">        <span class="string">"AppArmorProfile"</span>: <span class="string">""</span>,</span><br><span class="line">        <span class="string">"ExecIDs"</span>: null,</span><br><span class="line">        <span class="string">"HostConfig"</span>: &#123;</span><br><span class="line">            <span class="string">"Binds"</span>: null,</span><br><span class="line">            <span class="string">"ContainerIDFile"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"LogConfig"</span>: &#123;</span><br><span class="line">                <span class="string">"Type"</span>: <span class="string">"json-file"</span>,</span><br><span class="line">                <span class="string">"Config"</span>: &#123;&#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">"NetworkMode"</span>: <span class="string">"default"</span>,</span><br><span class="line">            <span class="string">"PortBindings"</span>: &#123;&#125;,</span><br><span class="line">            <span class="string">"RestartPolicy"</span>: &#123;</span><br><span class="line">                <span class="string">"Name"</span>: <span class="string">"no"</span>,</span><br><span class="line">                <span class="string">"MaximumRetryCount"</span>: 0</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">"AutoRemove"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">"VolumeDriver"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"VolumesFrom"</span>: null,</span><br><span class="line">            <span class="string">"CapAdd"</span>: null,</span><br><span class="line">            <span class="string">"CapDrop"</span>: null,</span><br><span class="line">            <span class="string">"Dns"</span>: [],</span><br><span class="line">            <span class="string">"DnsOptions"</span>: [],</span><br><span class="line">            <span class="string">"DnsSearch"</span>: [],</span><br><span class="line">            <span class="string">"ExtraHosts"</span>: null,</span><br><span class="line">            <span class="string">"GroupAdd"</span>: null,</span><br><span class="line">            <span class="string">"IpcMode"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"Cgroup"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"Links"</span>: null,</span><br><span class="line">            <span class="string">"OomScoreAdj"</span>: 0,</span><br><span class="line">            <span class="string">"PidMode"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"Privileged"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">"PublishAllPorts"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">"ReadonlyRootfs"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">"SecurityOpt"</span>: null,</span><br><span class="line">            <span class="string">"UTSMode"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"UsernsMode"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"ShmSize"</span>: 67108864,</span><br><span class="line">            <span class="string">"Runtime"</span>: <span class="string">"runc"</span>,</span><br><span class="line">            <span class="string">"ConsoleSize"</span>: [</span><br><span class="line">                0,</span><br><span class="line">                0</span><br><span class="line">            ],</span><br><span class="line">            <span class="string">"Isolation"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"CpuShares"</span>: 0,</span><br><span class="line">            <span class="string">"Memory"</span>: 0,</span><br><span class="line">            <span class="string">"NanoCpus"</span>: 0,</span><br><span class="line">            <span class="string">"CgroupParent"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"BlkioWeight"</span>: 0,</span><br><span class="line">            <span class="string">"BlkioWeightDevice"</span>: null,</span><br><span class="line">            <span class="string">"BlkioDeviceReadBps"</span>: null,</span><br><span class="line">            <span class="string">"BlkioDeviceWriteBps"</span>: null,</span><br><span class="line">            <span class="string">"BlkioDeviceReadIOps"</span>: null,</span><br><span class="line">            <span class="string">"BlkioDeviceWriteIOps"</span>: null,</span><br><span class="line">            <span class="string">"CpuPeriod"</span>: 0,</span><br><span class="line">            <span class="string">"CpuQuota"</span>: 0,</span><br><span class="line">            <span class="string">"CpuRealtimePeriod"</span>: 0,</span><br><span class="line">            <span class="string">"CpuRealtimeRuntime"</span>: 0,</span><br><span class="line">            <span class="string">"CpusetCpus"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"CpusetMems"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"Devices"</span>: [],</span><br><span class="line">            <span class="string">"DiskQuota"</span>: 0,</span><br><span class="line">            <span class="string">"KernelMemory"</span>: 0,</span><br><span class="line">            <span class="string">"MemoryReservation"</span>: 0,</span><br><span class="line">            <span class="string">"MemorySwap"</span>: 0,</span><br><span class="line">            <span class="string">"MemorySwappiness"</span>: -1,</span><br><span class="line">            <span class="string">"OomKillDisable"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">"PidsLimit"</span>: 0,</span><br><span class="line">            <span class="string">"Ulimits"</span>: null,</span><br><span class="line">            <span class="string">"CpuCount"</span>: 0,</span><br><span class="line">            <span class="string">"CpuPercent"</span>: 0,</span><br><span class="line">            <span class="string">"IOMaximumIOps"</span>: 0,</span><br><span class="line">            <span class="string">"IOMaximumBandwidth"</span>: 0</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"GraphDriver"</span>: &#123;</span><br><span class="line">            <span class="string">"Name"</span>: <span class="string">"overlay"</span>,</span><br><span class="line">            <span class="string">"Data"</span>: &#123;</span><br><span class="line">                <span class="string">"LowerDir"</span>: <span class="string">"/var/lib/docker/overlay/688f7629e585caacaa7e6e584a6c9caa8a4674cced37329df1ddac6e97b91f09/root"</span>,</span><br><span class="line">                <span class="string">"MergedDir"</span>: <span class="string">"/var/lib/docker/overlay/0552e76e57e334d1f6430054a619f7f3c992b8f8aca582764ab391b98bcd4703/merged"</span>,</span><br><span class="line">                <span class="string">"UpperDir"</span>: <span class="string">"/var/lib/docker/overlay/0552e76e57e334d1f6430054a619f7f3c992b8f8aca582764ab391b98bcd4703/upper"</span>,</span><br><span class="line">                <span class="string">"WorkDir"</span>: <span class="string">"/var/lib/docker/overlay/0552e76e57e334d1f6430054a619f7f3c992b8f8aca582764ab391b98bcd4703/work"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"Mounts"</span>: [],</span><br><span class="line">        <span class="string">"Config"</span>: &#123;</span><br><span class="line">            <span class="string">"Hostname"</span>: <span class="string">"67481376c1db"</span>,</span><br><span class="line">            <span class="string">"Domainname"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"User"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"AttachStdin"</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="string">"AttachStdout"</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="string">"AttachStderr"</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="string">"Tty"</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="string">"OpenStdin"</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="string">"StdinOnce"</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="string">"Env"</span>: [</span><br><span class="line">                <span class="string">"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="string">"Cmd"</span>: [</span><br><span class="line">                <span class="string">"/bin/bash"</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="string">"Image"</span>: <span class="string">"ubuntu"</span>,</span><br><span class="line">            <span class="string">"Volumes"</span>: null,</span><br><span class="line">            <span class="string">"WorkingDir"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"Entrypoint"</span>: null,</span><br><span class="line">            <span class="string">"OnBuild"</span>: null,</span><br><span class="line">            <span class="string">"Labels"</span>: &#123;&#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"NetworkSettings"</span>: &#123;</span><br><span class="line">            <span class="string">"Bridge"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"SandboxID"</span>: <span class="string">"ad68e2577a7ebe43ec48ba6768f04c06dc169891e687115d6ab75de60f3eb4d5"</span>,</span><br><span class="line">            <span class="string">"HairpinMode"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">"LinkLocalIPv6Address"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"LinkLocalIPv6PrefixLen"</span>: 0,</span><br><span class="line">            <span class="string">"Ports"</span>: null,</span><br><span class="line">            <span class="string">"SandboxKey"</span>: <span class="string">"/var/run/docker/netns/ad68e2577a7e"</span>,</span><br><span class="line">            <span class="string">"SecondaryIPAddresses"</span>: null,</span><br><span class="line">            <span class="string">"SecondaryIPv6Addresses"</span>: null,</span><br><span class="line">            <span class="string">"EndpointID"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"Gateway"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"GlobalIPv6Address"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"GlobalIPv6PrefixLen"</span>: 0,</span><br><span class="line">            <span class="string">"IPAddress"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"IPPrefixLen"</span>: 0,</span><br><span class="line">            <span class="string">"IPv6Gateway"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"MacAddress"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"Networks"</span>: &#123;</span><br><span class="line">                <span class="string">"bridge"</span>: &#123;</span><br><span class="line">                    <span class="string">"IPAMConfig"</span>: null,</span><br><span class="line">                    <span class="string">"Links"</span>: null,</span><br><span class="line">                    <span class="string">"Aliases"</span>: null,</span><br><span class="line">                    <span class="string">"NetworkID"</span>: <span class="string">"b8c608e9ba75a173d2d4dc89947f75d7c97204e874382dfb75d4806dcf6648ac"</span>,</span><br><span class="line">                    <span class="string">"EndpointID"</span>: <span class="string">""</span>,</span><br><span class="line">                    <span class="string">"Gateway"</span>: <span class="string">""</span>,</span><br><span class="line">                    <span class="string">"IPAddress"</span>: <span class="string">""</span>,</span><br><span class="line">                    <span class="string">"IPPrefixLen"</span>: 0,</span><br><span class="line">                    <span class="string">"IPv6Gateway"</span>: <span class="string">""</span>,</span><br><span class="line">                    <span class="string">"GlobalIPv6Address"</span>: <span class="string">""</span>,</span><br><span class="line">                    <span class="string">"GlobalIPv6PrefixLen"</span>: 0,</span><br><span class="line">                    <span class="string">"MacAddress"</span>: <span class="string">""</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line">[root@docker ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="自定义容器的名字"><a href="#自定义容器的名字" class="headerlink" title="自定义容器的名字"></a>自定义容器的名字</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker container run -it --name mwj ubuntu		#在启动容器时指定名字，不能重复使用已有的名字</span></span><br><span class="line">root@07905cebf525:/<span class="comment"># exit</span></span><br><span class="line">[root@docker ~]<span class="comment"># docker container ls -a </span></span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                      PORTS               NAMES</span><br><span class="line">07905cebf525        ubuntu              <span class="string">"/bin/bash"</span>              27 seconds ago      Exited (0) 15 seconds ago                       mwj</span><br><span class="line">67481376c1db        ubuntu              <span class="string">"/bin/bash"</span>              15 minutes ago      Exited (0) 15 minutes ago                       unruffled_mahavira</span><br><span class="line">a0de49b1f37b        ubuntu              <span class="string">"cat /etc/lsb-release"</span>   15 minutes ago      Exited (0) 15 minutes ago                       sleepy_wozniak</span><br></pre></td></tr></table></figure>

<h3 id="重新启动已经停止的容器"><a href="#重新启动已经停止的容器" class="headerlink" title="重新启动已经停止的容器"></a>重新启动已经停止的容器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker container ls -a		#以交互的方式进入一个已经退出的容器</span></span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                      PORTS               NAMES</span><br><span class="line">07905cebf525        ubuntu              <span class="string">"/bin/bash"</span>              21 minutes ago      Exited (0) 30 seconds ago                       mwj</span><br><span class="line">67481376c1db        ubuntu              <span class="string">"/bin/bash"</span>              36 minutes ago      Exited (0) 36 minutes ago                       unruffled_mahavira</span><br><span class="line">a0de49b1f37b        ubuntu              <span class="string">"cat /etc/lsb-release"</span>   36 minutes ago      Exited (0) 36 minutes ago                       sleepy_wozniak</span><br><span class="line">[root@docker ~]<span class="comment"># docker start -i mwj	#不加-i参数不会进入容器</span></span><br><span class="line">root@07905cebf525:/<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="删除已经停止的容器"><a href="#删除已经停止的容器" class="headerlink" title="删除已经停止的容器"></a>删除已经停止的容器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker container ls -a		#只能删除已经停止的容器</span></span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                   PORTS               NAMES</span><br><span class="line">07905cebf525        ubuntu              <span class="string">"/bin/bash"</span>              4 hours ago         Up 4 hours                                   mwj</span><br><span class="line">67481376c1db        ubuntu              <span class="string">"/bin/bash"</span>              4 hours ago         Exited (0) 4 hours ago                       unruffled_mahavira</span><br><span class="line">a0de49b1f37b        ubuntu              <span class="string">"cat /etc/lsb-release"</span>   4 hours ago         Exited (0) 4 hours ago                       sleepy_wozniak</span><br><span class="line">[root@docker ~]<span class="comment"># docker rm a0de49b1f37b</span></span><br><span class="line">a0de49b1f37b</span><br><span class="line">[root@docker ~]<span class="comment"># docker container ls -a</span></span><br><span class="line">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                   PORTS               NAMES</span><br><span class="line">07905cebf525        ubuntu              <span class="string">"/bin/bash"</span>         4 hours ago         Up 4 hours                                   mwj</span><br><span class="line">67481376c1db        ubuntu              <span class="string">"/bin/bash"</span>         4 hours ago         Exited (0) 4 hours ago                       unruffled_mahavira</span><br><span class="line">[root@docker ~]<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[root@docker ~]<span class="comment"># docker container run -it --rm --name="test" centos:7.6.1810 /bin/bash	#添加--rm参数可以在退出容器时自动将容器删除</span></span><br><span class="line">[root@ffd9ef6d97cb /]<span class="comment"># </span></span><br><span class="line">[root@ffd9ef6d97cb /]<span class="comment"># </span></span><br><span class="line">[root@ffd9ef6d97cb /]<span class="comment"># exit</span></span><br><span class="line">[root@docker ~]<span class="comment"># docker container ls -a</span></span><br><span class="line">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                   PORTS               NAMES</span><br><span class="line">07905cebf525        ubuntu              <span class="string">"/bin/bash"</span>         4 hours ago         Up 4 hours                                   mwj</span><br><span class="line">67481376c1db        ubuntu              <span class="string">"/bin/bash"</span>         4 hours ago         Exited (0) 4 hours ago                       unruffled_mahavira</span><br><span class="line">[root@docker ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="Docker守护式容器"><a href="#Docker守护式容器" class="headerlink" title="Docker守护式容器"></a>Docker守护式容器</h2><h3 id="什么是守护式容器？"><a href="#什么是守护式容器？" class="headerlink" title="什么是守护式容器？"></a>什么是守护式容器？</h3><ol>
<li>能够长期运行</li>
<li>没有交互式会话</li>
<li>非常适合运行应用程序或者服务</li>
</ol>
<h3 id="以守护形式运行容器"><a href="#以守护形式运行容器" class="headerlink" title="以守护形式运行容器"></a>以守护形式运行容器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker container run -it centos:7.6.1810 /bin/bash</span></span><br><span class="line">[root@67ff1e2c55c2 /]<span class="comment"># [root@docker ~]# 	#Ctrl+PQ退出并将容器放到后台运行</span></span><br><span class="line">[root@docker ~]<span class="comment"># docker container ls -a</span></span><br><span class="line">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES</span><br><span class="line">67ff1e2c55c2        centos:7.6.1810     <span class="string">"/bin/bash"</span>         21 seconds ago      Up 20 seconds                           eloquent_hopper</span><br><span class="line">[root@docker ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="启动守护式容器"><a href="#启动守护式容器" class="headerlink" title="启动守护式容器"></a>启动守护式容器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker container run -d --name="shell" centos:7.6.1810 /bin/bash -c "while true;do echo hello world; sleep 1;done"</span></span><br><span class="line">4c4f3b0b5b7ad33eb283edf3d9791d1cb50aad616d1245374510f25135c1a972</span><br><span class="line">[root@docker ~]<span class="comment"># docker container ls -a</span></span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES</span><br><span class="line">4c4f3b0b5b7a        centos:7.6.1810     <span class="string">"/bin/bash -c 'whi..."</span>   9 seconds ago       Up 8 seconds                            shell</span><br><span class="line">[root@docker ~]<span class="comment">#	#在启动容器时执行一个死循环，让容器一直运行，如果只是单纯的加-d参数将容器放到后台，容器会是退出的状态</span></span><br></pre></td></tr></table></figure>

<h3 id="如何查看容器内部运行的情况呢？"><a href="#如何查看容器内部运行的情况呢？" class="headerlink" title="如何查看容器内部运行的情况呢？"></a>如何查看容器内部运行的情况呢？</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker logs -f -t shell	#利用容器的日志logs去查看刚才执行死循环的容器，也可以使用tail命令查看</span></span><br><span class="line">2019-07-31T08:28:42.044371339Z hello world</span><br><span class="line">2019-07-31T08:28:43.049225671Z hello world</span><br><span class="line">2019-07-31T08:28:44.050978845Z hello world</span><br><span class="line">2019-07-31T08:28:45.053612590Z hello world</span><br><span class="line">2019-07-31T08:28:46.054194159Z hello world</span><br><span class="line">2019-07-31T08:28:47.055889712Z hello world</span><br><span class="line">2019-07-31T08:28:48.057540194Z hello world</span><br><span class="line">2019-07-31T08:28:49.058689431Z hello world</span><br><span class="line">2019-07-31T08:28:50.061623553Z hello world</span><br><span class="line">2019-07-31T08:28:51.062316325Z hello world</span><br><span class="line">2019-07-31T08:28:52.063958674Z hello world</span><br><span class="line">2019-07-31T08:28:53.066595699Z hello world</span><br><span class="line">2019-07-31T08:28:54.067589329Z hello world</span><br><span class="line">2019-07-31T08:28:55.069078651Z hello world</span><br><span class="line">2019-07-31T08:28:56.070604546Z hello world</span><br><span class="line">2019-07-31T08:28:57.073304208Z hello world</span><br><span class="line">2019-07-31T08:28:58.075061319Z hello world</span><br></pre></td></tr></table></figure>

<h3 id="查看容器内部的进程"><a href="#查看容器内部的进程" class="headerlink" title="查看容器内部的进程"></a>查看容器内部的进程</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker top shell	#容器内部运行的进程情况</span></span><br><span class="line">UID                 PID                 PPID                C                   STIME               TTY                 TIME                CMD</span><br><span class="line">root                14396               14384               0                   16:28               ?                   00:00:00            /bin/bash -c <span class="keyword">while</span> <span class="literal">true</span>;<span class="keyword">do</span> <span class="built_in">echo</span> </span><br><span class="line">hello world; sleep 1;doneroot                15044               14396               0                   16:37               ?                   00:00:00            sleep 1</span><br><span class="line">[root@docker ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="在已经运行的容器启动新的进程"><a href="#在已经运行的容器启动新的进程" class="headerlink" title="在已经运行的容器启动新的进程"></a>在已经运行的容器启动新的进程</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker exec -it shell /bin/bash</span></span><br><span class="line">[root@4c4f3b0b5b7a /]<span class="comment"># [root@docker ~]# 	#ctrl+PQ退出</span></span><br><span class="line">[root@docker ~]<span class="comment"># docker top shell	#容器后台多了一个进程</span></span><br><span class="line">UID                 PID                 PPID                C                   STIME               TTY                 TIME                CMD</span><br><span class="line">root                14396               14384               0                   16:28               ?                   00:00:00            /bin/bash -c <span class="keyword">while</span> <span class="literal">true</span>;<span class="keyword">do</span> <span class="built_in">echo</span> h</span><br><span class="line">ello world; sleep 1;doneroot                16113               16104               0                   16:47               pts/0               00:00:00            /bin/bash</span><br><span class="line">root                16140               14396               0                   16:47               ?                   00:00:00            sleep 1</span><br><span class="line">[root@docker ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="停止守护式容器"><a href="#停止守护式容器" class="headerlink" title="停止守护式容器"></a>停止守护式容器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker container ls -a</span></span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                    PORTS               NAMES</span><br><span class="line">d899667a2160        ubuntu              <span class="string">"/bin/bash"</span>              2 seconds ago       Exited (0) 1 second ago                       stoic_mayer</span><br><span class="line">4c4f3b0b5b7a        centos:7.6.1810     <span class="string">"/bin/bash -c 'whi..."</span>   32 minutes ago      Up 32 minutes                                 shell</span><br><span class="line">[root@docker ~]<span class="comment"># docker stop shell	#会发送命令给容器，有一个停止的过程</span></span><br><span class="line">shell</span><br><span class="line">[root@docker ~]<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[root@docker ~]<span class="comment"># docker container ls -a</span></span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                      PORTS               NAMES</span><br><span class="line">d899667a2160        ubuntu              <span class="string">"/bin/bash"</span>              2 minutes ago       Exited (0) 20 seconds ago                       stoic_mayer</span><br><span class="line">4c4f3b0b5b7a        centos:7.6.1810     <span class="string">"/bin/bash -c 'whi..."</span>   35 minutes ago      Up 4 seconds                                    shell</span><br><span class="line">[root@docker ~]<span class="comment"># docker kill shell	#立刻停止容器，不需要等待，可能会造成数据丢失</span></span><br><span class="line">shell</span><br><span class="line">[root@docker ~]<span class="comment"># docker container ls -a</span></span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                       PORTS               NAMES</span><br><span class="line">d899667a2160        ubuntu              <span class="string">"/bin/bash"</span>              2 minutes ago       Exited (0) 30 seconds ago                        stoic_mayer</span><br><span class="line">4c4f3b0b5b7a        centos:7.6.1810     <span class="string">"/bin/bash -c 'whi..."</span>   35 minutes ago      Exited (137) 2 seconds ago                       shell</span><br><span class="line">[root@docker ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="容器中部署静态网站"><a href="#容器中部署静态网站" class="headerlink" title="容器中部署静态网站"></a>容器中部署静态网站</h2><h3 id="启动Ubuntu容器"><a href="#启动Ubuntu容器" class="headerlink" title="启动Ubuntu容器"></a>启动Ubuntu容器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker container run -p 80 --name="web" -it ubuntu /bin/bash	--将容器的80端口映射到宿主机的随机端口</span></span><br><span class="line">root@67cdc97159eb:/<span class="comment"># apt-get install -y nginx	#安装nginx</span></span><br></pre></td></tr></table></figure>

<h3 id="配置NGINX"><a href="#配置NGINX" class="headerlink" title="配置NGINX"></a>配置NGINX</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@ec4c9bdbd2fb /]<span class="comment"># cat /usr/share/nginx/html/index.html	</span></span><br><span class="line">Test Nginx</span><br><span class="line">[root@ec4c9bdbd2fb /]<span class="comment"># nginx	#启动nginx</span></span><br></pre></td></tr></table></figure>

<h3 id="浏览器查看"><a href="#浏览器查看" class="headerlink" title="浏览器查看"></a>浏览器查看</h3><h4 id="先查看端口映射"><a href="#先查看端口映射" class="headerlink" title="先查看端口映射"></a>先查看端口映射</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker container ls -a		#由于前面定义的是随机宿主机的端口，现在看到宿主机的32769端口被映射到容器的80端口</span></span><br><span class="line">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                   NAMES</span><br><span class="line">ec4c9bdbd2fb        centos:7.6.1810     <span class="string">"/bin/bash"</span>         55 minutes ago      Up 55 minutes       0.0.0.0:32769-&gt;80/tcp   web</span><br><span class="line">[root@docker ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h4 id="访问测试"><a href="#访问测试" class="headerlink" title="访问测试"></a>访问测试</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># curl http://10.0.0.23:32769	#可以直观的看到宿主机的32769端口会被跳转到容器的80端口</span></span><br><span class="line">Test Nginx</span><br><span class="line">[root@docker ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h4 id="浏览器访问"><a href="#浏览器访问" class="headerlink" title="浏览器访问"></a>浏览器访问</h4><p><img alt data-src="https://puui.qpic.cn/fans_admin/0/3_1206436828_1573729628062/0" class="lozad"></p>
<h2 id="端口映射的方式"><a href="#端口映射的方式" class="headerlink" title="端口映射的方式"></a>端口映射的方式</h2><h3 id="将容器所有公开的端口发布到宿主机随机端口"><a href="#将容器所有公开的端口发布到宿主机随机端口" class="headerlink" title="将容器所有公开的端口发布到宿主机随机端口"></a>将容器所有公开的端口发布到宿主机随机端口</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker run -P -it ubuntu /bin/bash</span></span><br></pre></td></tr></table></figure>

<h3 id="指定映射容器的那些端口"><a href="#指定映射容器的那些端口" class="headerlink" title="指定映射容器的那些端口"></a>指定映射容器的那些端口</h3><h4 id="只指定容器的端口"><a href="#只指定容器的端口" class="headerlink" title="只指定容器的端口"></a>只指定容器的端口</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker run -p 80 -it ubuntu /bin/bash	#将容器的80端口映射到宿主机的随机端口</span></span><br></pre></td></tr></table></figure>

<h4 id="指定宿主机和容器的端口"><a href="#指定宿主机和容器的端口" class="headerlink" title="指定宿主机和容器的端口"></a>指定宿主机和容器的端口</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker run -p 8080:80 -it ubuntu /bin/bash		#将宿主机的8080端口映射到容器的80端口</span></span><br></pre></td></tr></table></figure>

<h4 id="指定IP地址和宿主机、容器的端口"><a href="#指定IP地址和宿主机、容器的端口" class="headerlink" title="指定IP地址和宿主机、容器的端口"></a>指定IP地址和宿主机、容器的端口</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker run -p 10.0.0.23:8080:80 -it ubuntu /bin/bash	#将访问宿主机10.0.0.23:80地址的转发到容器的80端口</span></span><br></pre></td></tr></table></figure>

<h4 id="指定IP地址和容器的端口"><a href="#指定IP地址和容器的端口" class="headerlink" title="指定IP地址和容器的端口"></a>指定IP地址和容器的端口</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -p 172.16.1.23::80 -it ubuntu /bin/bash		<span class="comment">#将宿主机172.16.1.23网卡的一个随机端口映射到容器的80端口</span></span><br></pre></td></tr></table></figure>

<h4 id="查看端口映射情况"><a href="#查看端口映射情况" class="headerlink" title="查看端口映射情况"></a>查看端口映射情况</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker container  ls</span></span><br><span class="line">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                       NAMES</span><br><span class="line">6a2074e850dc        ubuntu              <span class="string">"/bin/bash"</span>         2 minutes ago       Up 2 minutes        172.16.1.23:32768-&gt;80/tcp   adoring_gates</span><br><span class="line">bbeb304963a0        ubuntu              <span class="string">"/bin/bash"</span>         5 minutes ago       Up 5 minutes        10.0.0.23:8080-&gt;80/tcp      gifted_curran</span><br><span class="line">[root@docker ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="查看和删除镜像"><a href="#查看和删除镜像" class="headerlink" title="查看和删除镜像"></a>查看和删除镜像</h2><h3 id="镜像存放的位置"><a href="#镜像存放的位置" class="headerlink" title="镜像存放的位置"></a>镜像存放的位置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># ll /var/lib/docker/</span></span><br><span class="line">total 36</span><br><span class="line">drwx------  4 root root 4096 Aug  1 09:28 containers</span><br><span class="line">drwx------  3 root root 4096 Jul 30 21:57 image</span><br><span class="line">drwxr-x---  3 root root 4096 Jul 30 21:57 network</span><br><span class="line">drwx------ 13 root root 4096 Aug  1 09:28 overlay</span><br><span class="line">drwx------  4 root root 4096 Jul 30 21:57 plugins</span><br><span class="line">drwx------  2 root root 4096 Jul 30 21:57 swarm</span><br><span class="line">drwx------  2 root root 4096 Jul 31 10:51 tmp</span><br><span class="line">drwx------  2 root root 4096 Jul 30 21:57 trust</span><br><span class="line">drwx------  2 root root 4096 Jul 30 21:57 volumes</span><br><span class="line">[root@docker ~]<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[root@docker ~]<span class="comment"># docker info		#使用命令查看镜像存放位置，Docker Root Dir就是镜像目录</span></span><br><span class="line">Containers: 0</span><br><span class="line"> Running: 0</span><br><span class="line"> Paused: 0</span><br><span class="line"> Stopped: 0</span><br><span class="line">Images: 4</span><br><span class="line">Server Version: 17.03.2-ce</span><br><span class="line">Storage Driver: overlay</span><br><span class="line"> Backing Filesystem: extfs</span><br><span class="line"> Supports d_type: <span class="literal">true</span></span><br><span class="line">Logging Driver: json-file</span><br><span class="line">Cgroup Driver: cgroupfs</span><br><span class="line">Plugins: </span><br><span class="line"> Volume: <span class="built_in">local</span></span><br><span class="line"> Network: bridge host macvlan null overlay</span><br><span class="line">Swarm: inactive</span><br><span class="line">Runtimes: runc</span><br><span class="line">Default Runtime: runc</span><br><span class="line">Init Binary: docker-init</span><br><span class="line">containerd version: 4ab9917febca54791c5f071a9d1f404867857fcc</span><br><span class="line">runc version: 54296cf40ad8143b62dbcaa1d90e520a2136ddfe</span><br><span class="line">init version: 949e6fa</span><br><span class="line">Security Options:</span><br><span class="line"> seccomp</span><br><span class="line">  Profile: default</span><br><span class="line">Kernel Version: 3.10.0-957.el7.x86_64</span><br><span class="line">Operating System: CentOS Linux 7 (Core)</span><br><span class="line">OSType: linux</span><br><span class="line">Architecture: x86_64</span><br><span class="line">CPUs: 1</span><br><span class="line">Total Memory: 972.6 MiB</span><br><span class="line">Name: docker</span><br><span class="line">ID: DOBJ:26YX:KARR:N4NN:IN6G:AFTW:KPBG:PYCL:B5TD:JBAP:WL4W:MRDI</span><br><span class="line">Docker Root Dir: /var/lib/docker</span><br><span class="line">Debug Mode (client): <span class="literal">false</span></span><br><span class="line">Debug Mode (server): <span class="literal">false</span></span><br><span class="line">Registry: https://index.docker.io/v1/</span><br><span class="line">Experimental: <span class="literal">false</span></span><br><span class="line">Insecure Registries:</span><br><span class="line"> 127.0.0.0/8</span><br><span class="line">Registry Mirrors:</span><br><span class="line"> https://265wemgl.mirror.aliyuncs.com</span><br><span class="line">Live Restore Enabled: <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<h3 id="列出镜像"><a href="#列出镜像" class="headerlink" title="列出镜像"></a>列出镜像</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">-a	显示所有的镜像，默认不显示中间层的镜像</span><br><span class="line">-f	显示时的过滤条件</span><br><span class="line">--no-trunc	不使用截断镜像唯一ID的方式显示</span><br><span class="line">-q	只显示镜像的唯一ID</span><br><span class="line">[root@docker ~]<span class="comment"># docker images	#旧版显示，docker版本较低的只能使用此命令查看</span></span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">ubuntu              latest              3556258649b2        8 days ago          64.2 MB</span><br><span class="line">centos              7.6.1810            f1cb7c7d58b7        4 months ago        202 MB</span><br><span class="line">centos              latest              9f38484d220f        4 months ago        202 MB</span><br><span class="line">hello-world         latest              fce289e99eb9        7 months ago        1.84 kB</span><br><span class="line">[root@docker ~]<span class="comment"># docker image ls	#新版命令，兼容docker images显示</span></span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">ubuntu              latest              3556258649b2        8 days ago          64.2 MB</span><br><span class="line">centos              7.6.1810            f1cb7c7d58b7        4 months ago        202 MB</span><br><span class="line">centos              latest              9f38484d220f        4 months ago        202 MB</span><br><span class="line">hello-world         latest              fce289e99eb9        7 months ago        1.84 kB</span><br><span class="line">[root@docker ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<ol>
<li>REPOSITORY：仓库</li>
<li>TAG：标签，用于标识同一仓库下镜像的不同版本</li>
<li>IMAGE ID：镜像为唯一标识</li>
<li>CREATED：镜像的创建时间</li>
<li>SIZE：镜像的大小</li>
</ol>
<h3 id="查看镜像的详细内容"><a href="#查看镜像的详细内容" class="headerlink" title="查看镜像的详细内容"></a>查看镜像的详细内容</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker inspect centos:7.6.1810 </span></span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">"Id"</span>: <span class="string">"sha256:f1cb7c7d58b73eac859c395882eec49d50651244e342cd6c68a5c7809785f427"</span>,</span><br><span class="line">        <span class="string">"RepoTags"</span>: [</span><br><span class="line">            <span class="string">"centos:7.6.1810"</span></span><br><span class="line">        ],</span><br><span class="line">        <span class="string">"RepoDigests"</span>: [</span><br><span class="line">            <span class="string">"centos@sha256:62d9e1c2daa91166139b51577fe4f4f6b4cc41a3a2c7fc36bd895e2a17a3e4e6"</span></span><br><span class="line">        ],</span><br><span class="line">        <span class="string">"Parent"</span>: <span class="string">""</span>,</span><br><span class="line">        <span class="string">"Comment"</span>: <span class="string">""</span>,</span><br><span class="line">        <span class="string">"Created"</span>: <span class="string">"2019-03-14T21:20:29.635970966Z"</span>,</span><br><span class="line">        <span class="string">"Container"</span>: <span class="string">"cc6043a787f6d1c7ae3e121ebdf1c4478186336aa7274871780a0a7bcc3a061a"</span>,</span><br><span class="line">        <span class="string">"ContainerConfig"</span>: &#123;</span><br><span class="line">            <span class="string">"Hostname"</span>: <span class="string">"cc6043a787f6"</span>,</span><br><span class="line">            <span class="string">"Domainname"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"User"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"AttachStdin"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">"AttachStdout"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">"AttachStderr"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">"Tty"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">"OpenStdin"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">"StdinOnce"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">"Env"</span>: [</span><br><span class="line">                <span class="string">"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="string">"Cmd"</span>: [</span><br><span class="line">                <span class="string">"/bin/sh"</span>,</span><br><span class="line">                <span class="string">"-c"</span>,</span><br><span class="line">                <span class="string">"#(nop) "</span>,</span><br><span class="line">                <span class="string">"CMD [\"/bin/bash\"]"</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="string">"ArgsEscaped"</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="string">"Image"</span>: <span class="string">"sha256:698a0848ee35389ab7b98494bdc60f887c54ddb94fc2326a1fb4eff8895aff43"</span>,</span><br><span class="line">            <span class="string">"Volumes"</span>: null,</span><br><span class="line">            <span class="string">"WorkingDir"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"Entrypoint"</span>: null,</span><br><span class="line">            <span class="string">"OnBuild"</span>: null,</span><br><span class="line">            <span class="string">"Labels"</span>: &#123;</span><br><span class="line">                <span class="string">"org.label-schema.build-date"</span>: <span class="string">"20181204"</span>,</span><br><span class="line">                <span class="string">"org.label-schema.license"</span>: <span class="string">"GPLv2"</span>,</span><br><span class="line">                <span class="string">"org.label-schema.name"</span>: <span class="string">"CentOS Base Image"</span>,</span><br><span class="line">                <span class="string">"org.label-schema.schema-version"</span>: <span class="string">"1.0"</span>,</span><br><span class="line">                <span class="string">"org.label-schema.vendor"</span>: <span class="string">"CentOS"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"DockerVersion"</span>: <span class="string">"18.06.1-ce"</span>,</span><br><span class="line">        <span class="string">"Author"</span>: <span class="string">""</span>,</span><br><span class="line">        <span class="string">"Config"</span>: &#123;</span><br><span class="line">            <span class="string">"Hostname"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"Domainname"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"User"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"AttachStdin"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">"AttachStdout"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">"AttachStderr"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">"Tty"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">"OpenStdin"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">"StdinOnce"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">"Env"</span>: [</span><br><span class="line">                <span class="string">"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="string">"Cmd"</span>: [</span><br><span class="line">                <span class="string">"/bin/bash"</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="string">"ArgsEscaped"</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="string">"Image"</span>: <span class="string">"sha256:698a0848ee35389ab7b98494bdc60f887c54ddb94fc2326a1fb4eff8895aff43"</span>,</span><br><span class="line">            <span class="string">"Volumes"</span>: null,</span><br><span class="line">            <span class="string">"WorkingDir"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"Entrypoint"</span>: null,</span><br><span class="line">            <span class="string">"OnBuild"</span>: null,</span><br><span class="line">            <span class="string">"Labels"</span>: &#123;</span><br><span class="line">                <span class="string">"org.label-schema.build-date"</span>: <span class="string">"20181204"</span>,</span><br><span class="line">                <span class="string">"org.label-schema.license"</span>: <span class="string">"GPLv2"</span>,</span><br><span class="line">                <span class="string">"org.label-schema.name"</span>: <span class="string">"CentOS Base Image"</span>,</span><br><span class="line">                <span class="string">"org.label-schema.schema-version"</span>: <span class="string">"1.0"</span>,</span><br><span class="line">                <span class="string">"org.label-schema.vendor"</span>: <span class="string">"CentOS"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"Architecture"</span>: <span class="string">"amd64"</span>,</span><br><span class="line">        <span class="string">"Os"</span>: <span class="string">"linux"</span>,</span><br><span class="line">        <span class="string">"Size"</span>: 201756323,</span><br><span class="line">        <span class="string">"VirtualSize"</span>: 201756323,</span><br><span class="line">        <span class="string">"GraphDriver"</span>: &#123;</span><br><span class="line">            <span class="string">"Name"</span>: <span class="string">"overlay"</span>,</span><br><span class="line">            <span class="string">"Data"</span>: &#123;</span><br><span class="line">                <span class="string">"RootDir"</span>: <span class="string">"/var/lib/docker/overlay/7805437da00b08442f662a3d83fa728b7afc3f2ef60f296e2506330565ce5f87/root"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"RootFS"</span>: &#123;</span><br><span class="line">            <span class="string">"Type"</span>: <span class="string">"layers"</span>,</span><br><span class="line">            <span class="string">"Layers"</span>: [</span><br><span class="line">                <span class="string">"sha256:89169d87dbe2b72ba42bfbb3579c957322baca28e03a1e558076542a1c1b2b4a"</span></span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line">[root@docker ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="删除镜像"><a href="#删除镜像" class="headerlink" title="删除镜像"></a>删除镜像</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker rmi centos 	#可以是镜像名称或者是镜像ID</span></span><br><span class="line">Untagged: centos:latest</span><br><span class="line">Untagged: centos@sha256:a799dd8a2ded4a83484bbae769d97655392b3f86533ceb7dd96bbac929809f3c</span><br><span class="line">Deleted: sha256:9f38484d220fa527b1fb19747638497179500a1bed8bf0498eb788229229e6e1</span><br><span class="line">Deleted: sha256:d69483a6face4499acb974449d1303591fcbb5cdce5420f36f8a6607bda11854</span><br><span class="line">[root@docker ~]<span class="comment"># </span></span><br><span class="line"></span><br><span class="line">[root@docker ~]<span class="comment"># docker rmi $(docker image ls -a -q)	#删除所有镜像</span></span><br><span class="line">[root@docker ~]<span class="comment"># docker image ls -a -q |xargs rmi	#删除所有镜像</span></span><br></pre></td></tr></table></figure>

<h2 id="获取和推送镜像"><a href="#获取和推送镜像" class="headerlink" title="获取和推送镜像"></a>获取和推送镜像</h2><h3 id="搜索镜像"><a href="#搜索镜像" class="headerlink" title="搜索镜像"></a>搜索镜像</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker search ubuntu</span></span><br><span class="line">NAME                                                      DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED</span><br><span class="line">ubuntu                                                    Ubuntu is a Debian-based Linux operating s...   9787      [OK]       </span><br><span class="line">dorowu/ubuntu-desktop-lxde-vnc                            Docker image to provide HTML5 VNC interfac...   327                  [OK]</span><br><span class="line">rastasheep/ubuntu-sshd                                    Dockerized SSH service, built on top of of...   226                  [OK]</span><br><span class="line">consol/ubuntu-xfce-vnc                                    Ubuntu container with <span class="string">"headless"</span> VNC sessi...   184                  [OK]</span><br><span class="line">ubuntu-upstart                                            Upstart is an event-based replacement <span class="keyword">for</span> ...   99        [OK]       </span><br><span class="line">ansible/ubuntu14.04-ansible                               Ubuntu 14.04 LTS with ansible                   97                   [OK]</span><br><span class="line">1and1internet/ubuntu-16-nginx-php-phpmyadmin-mysql-5      ubuntu-16-nginx-php-phpmyadmin-mysql-5          50                   [OK]</span><br><span class="line">ubuntu-debootstrap                                        debootstrap --variant=minbase --components...   40        [OK]       </span><br><span class="line">i386/ubuntu                                               Ubuntu is a Debian-based Linux operating s...   18                   </span><br><span class="line">1and1internet/ubuntu-16-apache-php-5.6                    ubuntu-16-apache-php-5.6                        14                   [OK]</span><br><span class="line">ppc64le/ubuntu                                            Ubuntu is a Debian-based Linux operating s...   13                   </span><br><span class="line">1and1internet/ubuntu-16-apache-php-7.0                    ubuntu-16-apache-php-7.0                        13                   [OK]</span><br><span class="line">eclipse/ubuntu_jdk8                                       Ubuntu, JDK8, Maven 3, git, curl, nmap, mc...   11                   [OK]</span><br><span class="line">1and1internet/ubuntu-16-nginx-php-phpmyadmin-mariadb-10   ubuntu-16-nginx-php-phpmyadmin-mariadb-10       11                   [OK]</span><br><span class="line">1and1internet/ubuntu-16-nginx-php-5.6                     ubuntu-16-nginx-php-5.6                         8                    [OK]</span><br><span class="line">1and1internet/ubuntu-16-nginx-php-5.6-wordpress-4         ubuntu-16-nginx-php-5.6-wordpress-4             7                    [OK]</span><br><span class="line">1and1internet/ubuntu-16-apache-php-7.1                    ubuntu-16-apache-php-7.1                        6                    [OK]</span><br><span class="line">darksheer/ubuntu                                          Base Ubuntu Image -- Updated hourly             5                    [OK]</span><br><span class="line">1and1internet/ubuntu-16-nginx-php-7.0                     ubuntu-16-nginx-php-7.0                         4                    [OK]</span><br><span class="line">1and1internet/ubuntu-16-apache-php-5.6-zend-2             ubuntu-16-apache-php-5.6-zend-2                 2                    [OK]</span><br><span class="line">pivotaldata/ubuntu                                        A quick freshening-up of the base Ubuntu d...   2                    </span><br><span class="line">1and1internet/ubuntu-16-php-7.1                           ubuntu-16-php-7.1                               1                    [OK]</span><br><span class="line">1and1internet/ubuntu-16-sshd                              ubuntu-16-sshd                                  1                    [OK]</span><br><span class="line">smartentry/ubuntu                                         ubuntu with smartentry                          1                    [OK]</span><br><span class="line">pivotaldata/ubuntu-gpdb-dev                               Ubuntu images <span class="keyword">for</span> GPDB development              0                    </span><br><span class="line">[root@docker ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="拉取镜像"><a href="#拉取镜像" class="headerlink" title="拉取镜像"></a>拉取镜像</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker pull centos:7.6.1810	#不指定镜像的版本默认拉取最新的</span></span><br><span class="line">7.6.1810: Pulling from library/centos</span><br><span class="line">ac9208207ada: Pull complete </span><br><span class="line">Digest: sha256:62d9e1c2daa91166139b51577fe4f4f6b4cc41a3a2c7fc36bd895e2a17a3e4e6</span><br><span class="line">Status: Downloaded newer image <span class="keyword">for</span> centos:7.6.1810</span><br><span class="line">[root@docker ~]<span class="comment"># docker image ls</span></span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">centos              7.6.1810            f1cb7c7d58b7        4 months ago        202 MB</span><br><span class="line">[root@docker ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="推送镜像"><a href="#推送镜像" class="headerlink" title="推送镜像"></a>推送镜像</h3><h4 id="首先去docker-hub注册账号"><a href="#首先去docker-hub注册账号" class="headerlink" title="首先去docker hub注册账号"></a>首先去docker hub注册账号</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker tag f1cb7c7d58b7 missf2013/centos	#docker只会推送修改的部分镜像，直接推送未修改的镜像会出错</span></span><br><span class="line">[root@docker ~]<span class="comment"># docker login	--登录</span></span><br><span class="line">Login with your Docker ID to push and pull images from Docker Hub. If you don<span class="string">'t have a Docker ID, head over to https://hub.docker.com to create one.</span></span><br><span class="line"><span class="string">Username: missf2013	--docker hub的用户名</span></span><br><span class="line"><span class="string">Password: 	#密码</span></span><br><span class="line"><span class="string">Login Succeeded</span></span><br><span class="line"><span class="string">[root@docker ~]# docker push missf2013/centos</span></span><br><span class="line"><span class="string">The push refers to a repository [docker.io/missf2013/centos]</span></span><br><span class="line"><span class="string">89169d87dbe2: Pushing [==&gt;                                                ] 11.97 MB/201.8 MB</span></span><br><span class="line"><span class="string">#推送成功之后，登录自己的docker hub就能看到自己推送上来的镜像</span></span><br></pre></td></tr></table></figure>

<h2 id="构建镜像"><a href="#构建镜像" class="headerlink" title="构建镜像"></a>构建镜像</h2><h3 id="什么是构建镜像？"><a href="#什么是构建镜像？" class="headerlink" title="什么是构建镜像？"></a>什么是构建镜像？</h3><ol>
<li>保存对容器的修改，并再次使用</li>
<li>自定义镜像的能力</li>
<li>以软件的形式打包并分发服务器及其运行的环境</li>
<li>在其他主机上可以运行某个定义好的镜像，更方便的提供服务</li>
</ol>
<h3 id="两种构建镜像的方式"><a href="#两种构建镜像的方式" class="headerlink" title="两种构建镜像的方式"></a>两种构建镜像的方式</h3><h4 id="通过容器构建"><a href="#通过容器构建" class="headerlink" title="通过容器构建"></a>通过容器构建</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">-a	一般指定镜像的作者和联系方式</span><br><span class="line">-m	构建镜像的说明</span><br><span class="line">-p	可以不暂停容器进行构建</span><br><span class="line">[root@docker ~]<span class="comment"># docker container run -it centos:7.6.1810 	#启动一个容器</span></span><br><span class="line">[root@0bf0d905a865 /]<span class="comment"># yum install -y nginx		#做相应的修改</span></span><br><span class="line">[root@docker ~]<span class="comment"># docker container ls -a</span></span><br><span class="line">CONTAINER ID        IMAGE               COMMAND             CREATED              STATUS              PORTS               NAMES</span><br><span class="line">0bf0d905a865        centos:7.6.1810     <span class="string">"/bin/bash"</span>         About a minute ago   Up About a minute                       dazzling_bhabha</span><br><span class="line">[root@docker ~]<span class="comment"># docker commit -a "MoWenJie" -m "nginx" 0bf0d905a865 mwj/commit_nginx	--对一个运行中的容器镜像构建</span></span><br><span class="line">sha256:1f14b0232e4bc0c5054b974d825d1bd8586e269cd0be9338163cb203c9660ff1</span><br><span class="line">[root@docker ~]<span class="comment"># docker image ls -a		#可以看到新构建的镜像，容器再次启动是构建之后的环境</span></span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">mwj/commit_nginx    latest              1f14b0232e4b        9 seconds ago       293 MB</span><br><span class="line">centos              7.6.1810            f1cb7c7d58b7        4 months ago        202 MB</span><br><span class="line">missf2013/centos    latest              f1cb7c7d58b7        4 months ago        202 MB</span><br><span class="line">mowenjie/centos     latest              f1cb7c7d58b7        4 months ago        202 MB</span><br><span class="line">[root@docker ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="通过Dockerfile构建镜像"><a href="#通过Dockerfile构建镜像" class="headerlink" title="通过Dockerfile构建镜像"></a>通过Dockerfile构建镜像</h3><h4 id="什么是dockerfile？"><a href="#什么是dockerfile？" class="headerlink" title="什么是dockerfile？"></a>什么是dockerfile？</h4><p>Dockerfile是一个包含用于组合映像的命令的文本文档。可以使用在命令行中调用任何命令。 Docker通过读取<code>Dockerfile</code>中的指令自动生成映像</p>
<h4 id="dockerfile的基本结构"><a href="#dockerfile的基本结构" class="headerlink" title="dockerfile的基本结构"></a>dockerfile的基本结构</h4><p>Dockerfile 一般分为四部分：基础镜像信息、维护者信息、镜像操作指令和容器启动时执行指令</p>
<h4 id="dockerfile文件说明"><a href="#dockerfile文件说明" class="headerlink" title="dockerfile文件说明"></a>dockerfile文件说明</h4><p>Docker以从上到下的顺序运行Dockerfile的指令。为了指定基本映像，第一条指令必须是FROM，如果在同一个Dockerfile中创建多个镜像时，可以使用多个 FROM 指令</p>
<h4 id="通过dockerfile构建nginx"><a href="#通过dockerfile构建nginx" class="headerlink" title="通过dockerfile构建nginx"></a>通过dockerfile构建nginx</h4><p>1.在宿主机上创建工作目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># ll /dockerfile/nginx/		#编写dockerfile和启动脚本存放的目录</span></span><br><span class="line">total 8</span><br><span class="line">-rw-r--r-- 1 root root 471 Aug  5 09:27 dockerfile</span><br><span class="line">-rw-r--r-- 1 root root  40 Aug  5 09:11 run.sh</span><br><span class="line">[root@docker ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>2.dockerfile文件内容详解</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># cat /dockerfile/nginx/dockerfile</span></span><br><span class="line">FROM centos:7.6.1810	<span class="comment">#指定要用那个镜像来构建，不指定tag的话默认使用最新的</span></span><br><span class="line">MAINTAINER this is nginx image &lt;mwj&gt;	<span class="comment">#维护者信息</span></span><br><span class="line">RUN yum install -y wget proc-devel net-tools gcc zlib-devel make openssl-devel	<span class="comment">#安装依赖</span></span><br><span class="line">RUN wget http://nginx.org/download/nginx-1.9.9.tar.gz	<span class="comment">#下载nginx安装包</span></span><br><span class="line">RUN tar zxvf nginx-1.9.9.tar.gz		<span class="comment">#解压</span></span><br><span class="line">WORKDIR nginx-1.9.9		<span class="comment">#切换到解压后的目录</span></span><br><span class="line">RUN ./configure --prefix=/usr/<span class="built_in">local</span>/nginx &amp;&amp; make &amp;&amp; make install	<span class="comment">#编译安装</span></span><br><span class="line">EXPOSE 80	<span class="comment">#容器暴露自己的端口</span></span><br><span class="line">EXPOSE 443</span><br><span class="line">RUN <span class="built_in">echo</span> <span class="string">"daemon off;"</span> &gt;&gt;/usr/<span class="built_in">local</span>/nginx/conf/nginx.conf	<span class="comment">#关闭守护进程</span></span><br><span class="line">WORKDIR /dockerfile/nginx	<span class="comment">#切换到宿主机上的工作目录</span></span><br><span class="line">ADD run.sh /run.sh	<span class="comment">#创建run.sh启动文件</span></span><br><span class="line">RUN chmod 755 /run.sh	</span><br><span class="line">CMD [<span class="string">"/run.sh"</span>]		<span class="comment">#容器启动时所运行的命令</span></span><br><span class="line">[root@docker ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>3.启动脚本的内容</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># cat /dockerfile/nginx/run.sh </span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">/usr/<span class="built_in">local</span>/nginx/sbin/nginx</span><br><span class="line">[root@docker ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>4.生成镜像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># cd /dockerfile/nginx/ &amp;&amp; ll	#切换到dockerfile文件所在的目录</span></span><br><span class="line">total 8</span><br><span class="line">-rw-r--r-- 1 root root 484 Aug  5 23:01 dockerfile</span><br><span class="line">-rw-r--r-- 1 root root  40 Aug  5 09:11 run.sh</span><br><span class="line">[root@docker nginx]<span class="comment"># docker build -t "mwj/nginx:test" .		#在当前目录构建镜像</span></span><br><span class="line">Sending build context to Docker daemon 3.072 kB</span><br><span class="line">Step 1/14 : FROM centos:7.6.1810</span><br><span class="line"> ---&gt; f1cb7c7d58b7</span><br><span class="line">Step 2/14 : MAINTAINER this is nginx image &lt;mwj&gt;</span><br><span class="line"> ---&gt; [Warning] IPv4 forwarding is disabled. Networking will not work.</span><br><span class="line"> ---&gt; Running <span class="keyword">in</span> 07edb137e1a9</span><br><span class="line"> ---&gt; 5eeae1d37b2a</span><br><span class="line">......	--部分过程省略</span><br><span class="line">Removing intermediate container f60ac000f547</span><br><span class="line">Step 8/14 : EXPOSE 80</span><br><span class="line"> ---&gt; Running <span class="keyword">in</span> 7167f87d5461</span><br><span class="line"> ---&gt; ec2a78995353</span><br><span class="line">Removing intermediate container 7167f87d5461</span><br><span class="line">Step 9/14 : EXPOSE 443</span><br><span class="line"> ---&gt; Running <span class="keyword">in</span> a904fc8e3657</span><br><span class="line"> ---&gt; 737ed545b329</span><br><span class="line">Removing intermediate container a904fc8e3657</span><br><span class="line">Step 10/14 : RUN <span class="built_in">echo</span> <span class="string">"daemon off;"</span> &gt;&gt;/usr/<span class="built_in">local</span>/nginx/conf/nginx.conf</span><br><span class="line"> ---&gt; Running <span class="keyword">in</span> 7a71bbf8e5bc</span><br><span class="line"> ---&gt; 6f07999206e2</span><br><span class="line">Removing intermediate container 7a71bbf8e5bc</span><br><span class="line">Step 11/14 : WORKDIR /dockerfile/nginx</span><br><span class="line"> ---&gt; 222b78ff2097</span><br><span class="line">Removing intermediate container 3e37db11a06a</span><br><span class="line">Step 12/14 : ADD run.sh /run.sh</span><br><span class="line"> ---&gt; e877e927d669</span><br><span class="line">Removing intermediate container 9bb5b7f5a796</span><br><span class="line">Step 13/14 : RUN chmod 755 /run.sh</span><br><span class="line"> ---&gt; Running <span class="keyword">in</span> 33bdfff9dc37</span><br><span class="line"> ---&gt; 15ca51fc522d</span><br><span class="line">Removing intermediate container 33bdfff9dc37</span><br><span class="line">Step 14/14 : CMD /run.sh</span><br><span class="line"> ---&gt; Running <span class="keyword">in</span> 93007fe6278a</span><br><span class="line"> ---&gt; 4c941145fccd</span><br><span class="line">Removing intermediate container 93007fe6278a</span><br><span class="line">Successfully built 4c941145fccd</span><br></pre></td></tr></table></figure>

<p>5.启动容器并测试</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@docker nginx]<span class="comment"># docker image ls	#查看新构建的镜像nginx:test</span></span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED              SIZE</span><br><span class="line">nginx               <span class="built_in">test</span>                4c941145fccd        About a minute ago   417 MB</span><br><span class="line">nginx               latest              e445ab08b2be        12 days ago          126 MB</span><br><span class="line">ubuntu              latest              3556258649b2        12 days ago          64.2 MB</span><br><span class="line">centos              7.6.1810            f1cb7c7d58b7        4 months ago         202 MB</span><br><span class="line">centos              latest              9f38484d220f        4 months ago         202 MB</span><br><span class="line">[root@docker nginx]<span class="comment"># docker container run -d -P nginx:test 	#启动容器</span></span><br><span class="line">88fe466c011f94623f410f7c54f8182ab07e0b015a92287fd2f5bf9fd336b31d</span><br><span class="line">[root@docker ~]<span class="comment"># docker container ls -a		#查看容器的端口映射到宿主机的那个端口</span></span><br><span class="line">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                                         </span><br><span class="line">  NAMES88fe466c011f        nginx:<span class="built_in">test</span>          <span class="string">"/run.sh"</span>           25 minutes ago      Up 25 minutes       0.0.0.0:32771-&gt;80/tcp, 0.0.0.0:32770-&gt;443/tcp </span><br><span class="line">blissful_goldstine</span><br><span class="line">[root@docker ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>6.浏览器访问</p>
<p><img alt data-src="https://puui.qpic.cn/fans_admin/0/3_1409075683_1573729681528/0" class="lozad"></p>
<h2 id="Docker远程连接"><a href="#Docker远程连接" class="headerlink" title="Docker远程连接"></a>Docker远程连接</h2><h3 id="docker的c-s模式"><a href="#docker的c-s模式" class="headerlink" title="docker的c/s模式"></a>docker的c/s模式</h3><p>前面我们说过，Docker是基于C/S架构的程序，docker的客户端（就是我们的命令行）通过发送请求命令给Docker守护进程（docker daemon），Docker守护进程返回执行结果给客户端，然后显示在命令行界面。客户端和守护进程可以是在一台机器上，也可以是在不同的机器上，现在我们就来配置docker的远程连接。</p>
<h3 id="修改docker的启动脚本"><a href="#修改docker的启动脚本" class="headerlink" title="修改docker的启动脚本"></a>修改docker的启动脚本</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># cat /lib/systemd/system/docker.service </span></span><br><span class="line">[Unit]</span><br><span class="line">Description=Docker Application Container Engine</span><br><span class="line">Documentation=https://docs.docker.com</span><br><span class="line">After=network.target firewalld.service</span><br><span class="line">[Service]</span><br><span class="line">Type=notify</span><br><span class="line"><span class="comment"># the default is not to use systemd for cgroups because the delegate issues still</span></span><br><span class="line"><span class="comment"># exists and systemd currently does not support the cgroup feature set required</span></span><br><span class="line"><span class="comment"># for containers run by docker</span></span><br><span class="line">ExecStart=/usr/bin/dockerd -H tcp://0.0.0.0:2375 -H unix://var/run/docker.sock	<span class="comment">#添加docker的连接方式</span></span><br><span class="line">ExecReload=/bin/<span class="built_in">kill</span> -s HUP <span class="variable">$MAINPID</span></span><br><span class="line"><span class="comment"># Having non-zero Limit*s causes performance problems due to accounting overhead</span></span><br><span class="line"><span class="comment"># in the kernel. We recommend using cgroups to do container-local accounting.</span></span><br><span class="line">LimitNOFILE=infinity</span><br><span class="line">LimitNPROC=infinity</span><br><span class="line">LimitCORE=infinity</span><br><span class="line"><span class="comment"># Uncomment TasksMax if your systemd version supports it.</span></span><br><span class="line"><span class="comment"># Only systemd 226 and above support this version.</span></span><br><span class="line"><span class="comment">#TasksMax=infinity</span></span><br><span class="line">TimeoutStartSec=0</span><br><span class="line"><span class="comment"># set delegate yes so that systemd does not reset the cgroups of docker containers</span></span><br><span class="line">Delegate=yes</span><br><span class="line"><span class="comment"># kill only the docker process, not all processes in the cgroup</span></span><br><span class="line">KillMode=process</span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line">[root@docker ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="重启docker"><a href="#重启docker" class="headerlink" title="重启docker"></a>重启docker</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># systemctl daemon-reload</span></span><br><span class="line">[root@docker ~]<span class="comment"># systemctl restart docker.service</span></span><br><span class="line">[root@docker ~]<span class="comment"># ps -ef |grep docker	#可以看到docker守护进程已经在监听tcp2375端口</span></span><br><span class="line">root      17801      1  0 10:26 ?        00:00:00 /usr/bin/dockerd -H tcp://0.0.0.0:2375 -H unix://var/run/docker.sock</span><br><span class="line">root      17804  17801  0 10:26 ?        00:00:00 docker-containerd -l unix:///var/run/docker/libcontainerd/docker-containerd.sock --metrics-interval=0 --start-time</span><br><span class="line">out 2m --state-dir /var/run/docker/libcontainerd/containerd --shim docker-containerd-shim --runtime docker-runcroot      18001   7641  0 10:47 pts/0    00:00:00 grep --color=auto docker</span><br><span class="line">[root@docker ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="远程连接测试"><a href="#远程连接测试" class="headerlink" title="远程连接测试"></a>远程连接测试</h3><h4 id="浏览器测试"><a href="#浏览器测试" class="headerlink" title="浏览器测试"></a>浏览器测试</h4><p><img alt data-src="https://puui.qpic.cn/fans_admin/0/3_1440820042_1573729773936/0" class="lozad"></p>
<h4 id="使用另一台机器测试"><a href="#使用另一台机器测试" class="headerlink" title="使用另一台机器测试"></a>使用另一台机器测试</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-m ~]<span class="comment"># docker -H tcp://10.0.0.23:2375 images 	#连接到10.0.0.23主机可以看到主机上的镜像</span></span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">nginx               <span class="built_in">test</span>                4c941145fccd        About an hour ago   416.6 MB</span><br><span class="line">nginx               latest              e445ab08b2be        12 days ago         125.8 MB</span><br><span class="line">ubuntu              latest              3556258649b2        12 days ago         64.18 MB</span><br><span class="line">centos              7.6.1810            f1cb7c7d58b7        4 months ago        201.8 MB</span><br><span class="line">centos              latest              9f38484d220f        4 months ago        201.8 MB</span><br><span class="line">[root@k8s-m ~]<span class="comment">#</span></span><br><span class="line">[root@k8s-m ~]<span class="comment"># docker -H tcp://10.0.0.23:2375 rmi ubuntu	#可以使用远程的方式执行操作</span></span><br><span class="line">Untagged: ubuntu:latest</span><br><span class="line">Untagged: ubuntu@sha256:c303f19cfe9ee92badbbbd7567bc1ca47789f79303ddcef56f77687d4744cd7a</span><br><span class="line">Deleted: sha256:3556258649b2ef23a41812be17377d32f568ed9f45150a26466d2ea26d926c32</span><br><span class="line">Deleted: sha256:e68a9307017f6b268915b4d1b537ff663ff6967a37c85bd03a26f2e171ee9f6f</span><br><span class="line">Deleted: sha256:ed8308579f11f616d6b58e6e456f765f8e3837f69f81f7304f213c4e3aa96856</span><br><span class="line">Deleted: sha256:a757708db54bb9fe5cc7962e8890e008992209d6eca7d6556db03d2891159fef</span><br><span class="line">Deleted: sha256:543791078bdb84740cb5457abbea10d96dac3dea8c07d6dc173f734c20c144fe</span><br></pre></td></tr></table></figure>

<h2 id="Docker的基础网络类型"><a href="#Docker的基础网络类型" class="headerlink" title="Docker的基础网络类型"></a>Docker的基础网络类型</h2><h3 id="docker的四种网络类型"><a href="#docker的四种网络类型" class="headerlink" title="docker的四种网络类型"></a>docker的四种网络类型</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker network ls		#这里只能看到三种，还有一种网络类型是container</span></span><br><span class="line">NETWORK ID          NAME                DRIVER              SCOPE</span><br><span class="line">a9eb3a40813d        bridge              bridge              <span class="built_in">local</span></span><br><span class="line">7fa413c3bb93        host                host                <span class="built_in">local</span></span><br><span class="line">96b447ead50e        none                null                <span class="built_in">local</span></span><br></pre></td></tr></table></figure>

<h3 id="Bridge桥接模式"><a href="#Bridge桥接模式" class="headerlink" title="Bridge桥接模式"></a>Bridge桥接模式</h3><p>bridge桥接模式是容器启动时默认的网络模式，类似NAT模式，也可以用–net参数指定使用哪种网络模式启动容器。docker在启动时会创建一个虚拟网桥docker0，默认地址为172.17.0.1/16，容器启动后都会被桥接到docker0上，并自动分配到一个IP地址，进入容器使用ifconfig命令可以看到。</p>
<h4 id="启动两个容器"><a href="#启动两个容器" class="headerlink" title="启动两个容器"></a>启动两个容器</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">[root@docker nginx]<span class="comment"># docker run -it #name test1 mwj/nginx1 /bin/bash	--启动第一个容器</span></span><br><span class="line">[root@fd1dadb0cbd9 nginx]<span class="comment"># ifconfig		#IP地址为172.17.0.2</span></span><br><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.17.0.2  netmask 255.255.0.0  broadcast 0.0.0.0</span><br><span class="line">        inet6 fe80::42:acff:fe11:2  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        ether 02:42:ac:11:00:02  txqueuelen 0  (Ethernet)</span><br><span class="line">        RX packets 7  bytes 586 (586.0 B)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 7  bytes 586 (586.0 B)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line">[root@fd1dadb0cbd9 nginx]<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[root@docker ~]<span class="comment"># docker run -it #name test2 mwj/nginx2 /bin/bash	--启动第二个容器</span></span><br><span class="line">[root@246b09019a45 nginx]<span class="comment"># ifconfig		#IP地址为172.17.0.3</span></span><br><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.17.0.3  netmask 255.255.0.0  broadcast 0.0.0.0</span><br><span class="line">        inet6 fe80::42:acff:fe11:3  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        ether 02:42:ac:11:00:03  txqueuelen 0  (Ethernet)</span><br><span class="line">        RX packets 6  bytes 516 (516.0 B)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 6  bytes 516 (516.0 B)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line">[root@246b09019a45 nginx]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h4 id="容器间能互相ping通"><a href="#容器间能互相ping通" class="headerlink" title="容器间能互相ping通"></a>容器间能互相ping通</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">[root@fd1dadb0cbd9 nginx]<span class="comment"># ping 172.17.0.3</span></span><br><span class="line">PING 172.17.0.3 (172.17.0.3) 56(84) bytes of data.</span><br><span class="line">64 bytes from 172.17.0.3: icmp_seq=1 ttl=64 time=0.145 ms</span><br><span class="line">64 bytes from 172.17.0.3: icmp_seq=2 ttl=64 time=0.042 ms</span><br><span class="line">64 bytes from 172.17.0.3: icmp_seq=3 ttl=64 time=0.044 ms</span><br><span class="line"></span><br><span class="line">[root@246b09019a45 nginx]<span class="comment"># ping 172.17.0.2</span></span><br><span class="line">PING 172.17.0.2 (172.17.0.2) 56(84) bytes of data.</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=1 ttl=64 time=0.039 ms</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=2 ttl=64 time=0.043 ms</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=3 ttl=64 time=0.046 ms</span><br><span class="line"></span><br><span class="line">[root@246b09019a45 nginx]<span class="comment"># curl http://172.17.0.2	#同时也能互相访问彼此的nginx服务</span></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;Welcome to nginx!&lt;/title&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">    body &#123;</span><br><span class="line">        width: 35em;</span><br><span class="line">        margin: 0 auto;</span><br><span class="line">        font-family: Tahoma, Verdana, Arial, sans-serif;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;</span><br><span class="line">&lt;p&gt;If you see this page, the nginx web server is successfully installed and</span><br><span class="line">working. Further configuration is required.&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;For online documentation and support please refer to</span><br><span class="line">&lt;a href=<span class="string">"http://nginx.org/"</span>&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;</span><br><span class="line">Commercial support is available at</span><br><span class="line">&lt;a href=<span class="string">"http://nginx.com/"</span>&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;&lt;em&gt;Thank you <span class="keyword">for</span> using nginx.&lt;/em&gt;&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">[root@246b09019a45 nginx]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="Host网络模式"><a href="#Host网络模式" class="headerlink" title="Host网络模式"></a>Host网络模式</h3><p>host网络模式可以直接使用宿主机的IP地址与外界通信，若宿主机的eth0是一个公网的IP地址，那么容器同时也拥有了这个公网IP，而且容器内服务的端口也是使用宿主机的端口，无需通过NAT转换。这样无需再映射容器与宿主机之间的端口，但是会造成网络环境隔离性弱化，容器不再拥有隔离的网络，独立的网络。由于网络隔离性的弱化,该容器会与宿主机共享竞争网络资源和端口资源。</p>
<h4 id="使用host网络模式启动容器"><a href="#使用host网络模式启动容器" class="headerlink" title="使用host网络模式启动容器"></a>使用host网络模式启动容器</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker run -it --name host_test --net host centos:7.6.1810</span></span><br><span class="line">[root@docker /]<span class="comment"># docker     #看不出来变化，是因为主机名也是和宿主机一样，但是容器内是没有docker命令的</span></span><br><span class="line">bash: docker: <span class="built_in">command</span> not found</span><br><span class="line">[root@docker /]<span class="comment"># ip addr show	#查看IP完全和宿主机查看一样</span></span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 ::1/128 scope host </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: ens32: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000</span><br><span class="line">    link/ether 00:0c:29:65:ca:77 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 10.0.0.23/24 brd 10.0.0.255 scope global noprefixroute ens32</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">3: ens35: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000</span><br><span class="line">    link/ether 00:0c:29:65:ca:81 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 172.16.1.23/24 brd 172.16.1.255 scope global noprefixroute ens35</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::20c:29ff:fe65:ca81/64 scope link </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">4: docker0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state DOWN group default </span><br><span class="line">    link/ether 02:42:97:ac:69:e1 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 172.17.0.1/16 scope global docker0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::42:97ff:feac:69e1/64 scope link </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">[root@docker /]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="Container网络模式"><a href="#Container网络模式" class="headerlink" title="Container网络模式"></a>Container网络模式</h3><p>启动一个容器con1（被共享网络环境的容器），再启动一个容器con2（需要共享其他网络的容器），con2容器使用的是con1容器的命名空间（namespace），这种模式可以更好服务容器间的通信，docker可以通过localhost来访问命名空间下的其他容器，传输效率较高，虽然多个容器共享网络环境，但是多个容器形成的整体依然与宿主机以及其他容器形成网络隔离。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker container run -it --name con1 --net host centos:7.6.1810	#con1使用host网络模式</span></span><br><span class="line">[root@docker ~]<span class="comment"># docker container run -it --name con2 --net container:con1 centos:7.6.1810		#con2直接使用了con1的网络</span></span><br></pre></td></tr></table></figure>

<h3 id="None网络模式"><a href="#None网络模式" class="headerlink" title="None网络模式"></a>None网络模式</h3><p>网络环境为none，即不做任何网络环境的设定，容器内部就只能使用loopback网络设备,不会再有其他的网络资源。这样网络方式的用途是，将网络创建的责任完全交给用户，作为 Docker 开发者,才能在这基础做其他无限多可能的网络定制开发，这种方式可以实现更加灵活复杂的网络，同时也体现了Docker设计理念的开放。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker container run -it --name mwj1 --net none centos:7.6.1810</span></span><br><span class="line">[root@7beccfd72b65 /]<span class="comment"># ifconfig		#只能看到loopback网络设备</span></span><br><span class="line">1: lo:  mtu 65536 qdisc noqueue state UNKNOWN</span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 ::1/128 scope host</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br></pre></td></tr></table></figure>

<h2 id="Docker的数据卷"><a href="#Docker的数据卷" class="headerlink" title="Docker的数据卷"></a>Docker的数据卷</h2><h3 id="什么是数据卷？"><a href="#什么是数据卷？" class="headerlink" title="什么是数据卷？"></a>什么是数据卷？</h3><p>数据卷（Data volume）是经过特殊设计的目录，可以绕过联合文件系统（UFS），为一个或多个容器提供访问。可以简单的理解为：就是将宿主机的一个目录和容器的一个目录做了NFS，两个目录下创建的数据会被同步。</p>
<h3 id="关于UFS文件系统"><a href="#关于UFS文件系统" class="headerlink" title="关于UFS文件系统"></a>关于UFS文件系统</h3><p>联合文件系统（UnionFS）是一种分层、轻量级并且高性能的文件系统，它支持对文件系统的修改作为一次提交来一层层的叠加，同时可以将不同目录挂载到同一个虚拟文件系统下。<br>联合文件系统是 Docker 镜像的基础。镜像可以通过分层来进行继承，基于基础镜像（没有父镜像），可以制作各种具体的应用镜像。</p>
<h3 id="数据卷的设计目的"><a href="#数据卷的设计目的" class="headerlink" title="数据卷的设计目的"></a>数据卷的设计目的</h3><p>数据卷的设计目的，是为了使数据能够持久化，它和容器的生存周期完全独立，因此在容器被销毁是，docker不会删除容器所挂载的数据卷。</p>
<p><img alt data-src="https://puui.qpic.cn/fans_admin/0/3_1206436828_1573729838605/0" class="lozad"></p>
<p>从图中可以看到，三个容器都挂载了同一个数据卷，就是宿主机上的一个目录，每个容器在自己的数据卷目录下写入数据，都会被持久化到宿主机的数据卷目录。</p>
<h3 id="为容器添加数据卷"><a href="#为容器添加数据卷" class="headerlink" title="为容器添加数据卷"></a>为容器添加数据卷</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker container run -v /mwj:/data -it centos:7.6.1810 /bin/bash	--将宿主机的/mwj目录映射到容器的/data目录</span></span><br><span class="line">[root@551f34451c3b /]<span class="comment"># ll /		#容器中有了/data目录</span></span><br><span class="line">total 60</span><br><span class="line">-rw-r--r--  9 root root 12053 Dec  4  2018 anaconda-post.log</span><br><span class="line">lrwxrwxrwx  1 root root     7 Dec  4  2018 bin -&gt; usr/bin</span><br><span class="line">drwxr-xr-x  2 root root  4096 Aug  7 13:53 data</span><br><span class="line">drwxr-xr-x  5 root root   360 Aug  7 13:53 dev</span><br><span class="line">drwxr-xr-x  1 root root  4096 Aug  7 13:53 etc</span><br><span class="line">drwxr-xr-x  2 root root  4096 Apr 11  2018 home</span><br><span class="line">lrwxrwxrwx  1 root root     7 Dec  4  2018 lib -&gt; usr/lib</span><br><span class="line">lrwxrwxrwx  1 root root     9 Dec  4  2018 lib64 -&gt; usr/lib64</span><br><span class="line">drwxr-xr-x  2 root root  4096 Apr 11  2018 media</span><br><span class="line">drwxr-xr-x  2 root root  4096 Apr 11  2018 mnt</span><br><span class="line">drwxr-xr-x  2 root root  4096 Apr 11  2018 opt</span><br><span class="line">dr-xr-xr-x 97 root root     0 Aug  7 13:53 proc</span><br><span class="line">dr-xr-x---  2 root root  4096 Dec  4  2018 root</span><br><span class="line">drwxr-xr-x 11 root root  4096 Dec  4  2018 run</span><br><span class="line">lrwxrwxrwx  1 root root     8 Dec  4  2018 sbin -&gt; usr/sbin</span><br><span class="line">drwxr-xr-x  2 root root  4096 Apr 11  2018 srv</span><br><span class="line">dr-xr-xr-x 13 root root     0 Aug  5 01:22 sys</span><br><span class="line">drwxrwxrwt  7 root root  4096 Dec  4  2018 tmp</span><br><span class="line">drwxr-xr-x 13 root root  4096 Dec  4  2018 usr</span><br><span class="line">drwxr-xr-x 18 root root  4096 Dec  4  2018 var</span><br><span class="line">[root@551f34451c3b /]<span class="comment"># cd data/</span></span><br><span class="line">[root@551f34451c3b data]<span class="comment"># touch datavolume	#在data目录创建文件</span></span><br><span class="line">[root@551f34451c3b data]<span class="comment"># [root@docker ~]# 	#Ctrl p+q退出</span></span><br><span class="line">[root@docker ~]<span class="comment"># ll /mwj/	#容器中的数据被持久化到宿主机</span></span><br><span class="line">total 0</span><br><span class="line">-rw-r--r-- 1 root root 0 Aug  7 21:54 datavolume</span><br><span class="line">[root@docker ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="数据卷的权限设置"><a href="#数据卷的权限设置" class="headerlink" title="数据卷的权限设置"></a>数据卷的权限设置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker container run -v /mwj:/data:ro -it --name test1 centos:7.6.1810 /bin/bash	#启动容器时设置只读</span></span><br><span class="line">[root@871d945acf7c /]<span class="comment"># touch /data/123	#容器无法创建文件</span></span><br><span class="line">touch: cannot touch <span class="string">'/data/123'</span>: Read-only file system</span><br><span class="line">[root@871d945acf7c /]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="Docker的数据卷容器"><a href="#Docker的数据卷容器" class="headerlink" title="Docker的数据卷容器"></a>Docker的数据卷容器</h2><p><img alt data-src="https://puui.qpic.cn/fans_admin/0/3_1440792797_1573729868686/0" class="lozad"></p>
<p>数据卷容器挂载了一个宿主机的本地目录，其他容器通过连接数据卷容器来实现数据的共享。</p>
<h3 id="制作数据卷容器"><a href="#制作数据卷容器" class="headerlink" title="制作数据卷容器"></a>制作数据卷容器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># cat /dockerfile/volume/dockerfile	#dockerfile内容</span></span><br><span class="line">FROM centos</span><br><span class="line">VOLUME [<span class="string">"/datavolume1"</span>,<span class="string">"/datavolume2"</span>]</span><br><span class="line">CMD /bin/bash</span><br><span class="line">[root@docker volume]<span class="comment"># docker build -t datavo1 .</span></span><br><span class="line">Sending build context to Docker daemon 2.048 kB</span><br><span class="line">Step 1/3 : FROM centos</span><br><span class="line"> ---&gt; 9f38484d220f</span><br><span class="line">Step 2/3 : VOLUME /datavolume1 /datavolume2</span><br><span class="line"> ---&gt; Running <span class="keyword">in</span> 36070367e4c7</span><br><span class="line"> ---&gt; 7fa566737d45</span><br><span class="line">Removing intermediate container 36070367e4c7</span><br><span class="line">Step 3/3 : CMD /bin/bash</span><br><span class="line"> ---&gt; Running <span class="keyword">in</span> 31f938cd77fa</span><br><span class="line"> ---&gt; 5727bcde8e01</span><br><span class="line">Removing intermediate container 31f938cd77fa</span><br><span class="line">Successfully built 5727bcde8e01</span><br><span class="line">[root@docker volume]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="启动数据卷容器"><a href="#启动数据卷容器" class="headerlink" title="启动数据卷容器"></a>启动数据卷容器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">[root@docker volume]<span class="comment"># docker run -it --name dv1 datavo1</span></span><br><span class="line">[root@0afdb9533882 /]<span class="comment"># ll /		#可以看到已经有了datavolume1和datavolume2数据卷</span></span><br><span class="line">total 64</span><br><span class="line">-rw-r--r--  1 root root 12082 Mar  5 17:36 anaconda-post.log</span><br><span class="line">lrwxrwxrwx  1 root root     7 Mar  5 17:34 bin -&gt; usr/bin</span><br><span class="line">drwxr-xr-x  2 root root  4096 Aug  7 14:38 datavolume1</span><br><span class="line">drwxr-xr-x  2 root root  4096 Aug  7 14:38 datavolume2</span><br><span class="line">drwxr-xr-x  5 root root   360 Aug  7 14:38 dev</span><br><span class="line">drwxr-xr-x  1 root root  4096 Aug  7 14:38 etc</span><br><span class="line">drwxr-xr-x  2 root root  4096 Apr 11  2018 home</span><br><span class="line">lrwxrwxrwx  1 root root     7 Mar  5 17:34 lib -&gt; usr/lib</span><br><span class="line">lrwxrwxrwx  1 root root     9 Mar  5 17:34 lib64 -&gt; usr/lib64</span><br><span class="line">drwxr-xr-x  2 root root  4096 Apr 11  2018 media</span><br><span class="line">drwxr-xr-x  2 root root  4096 Apr 11  2018 mnt</span><br><span class="line">drwxr-xr-x  2 root root  4096 Apr 11  2018 opt</span><br><span class="line">dr-xr-xr-x 97 root root     0 Aug  7 14:38 proc</span><br><span class="line">dr-xr-x---  2 root root  4096 Mar  5 17:36 root</span><br><span class="line">drwxr-xr-x 11 root root  4096 Mar  5 17:36 run</span><br><span class="line">lrwxrwxrwx  1 root root     8 Mar  5 17:34 sbin -&gt; usr/sbin</span><br><span class="line">drwxr-xr-x  2 root root  4096 Apr 11  2018 srv</span><br><span class="line">dr-xr-xr-x 13 root root     0 Aug  5 01:22 sys</span><br><span class="line">drwxrwxrwt  7 root root  4096 Mar  5 17:36 tmp</span><br><span class="line">drwxr-xr-x 13 root root  4096 Mar  5 17:34 usr</span><br><span class="line">drwxr-xr-x 18 root root  4096 Mar  5 17:34 var</span><br><span class="line">[root@0afdb9533882 /]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="容器连接数据卷容器"><a href="#容器连接数据卷容器" class="headerlink" title="容器连接数据卷容器"></a>容器连接数据卷容器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker run -it --name dv2 --volumes-from dv1 centos:7.6.1810 /bin/bash</span></span><br><span class="line"><span class="comment">#启动容器dv2时指定已经挂载数据卷的容器dv1</span></span><br><span class="line">[root@e335b245323b /]<span class="comment"># ll /		#这时候dv1和dv2容器的数据卷目录已经可以共享数据</span></span><br><span class="line">total 64</span><br><span class="line">-rw-r--r--  9 root root 12053 Dec  4  2018 anaconda-post.log</span><br><span class="line">lrwxrwxrwx  1 root root     7 Dec  4  2018 bin -&gt; usr/bin</span><br><span class="line">drwxr-xr-x  2 root root  4096 Aug  7 14:38 datavolume1</span><br><span class="line">drwxr-xr-x  2 root root  4096 Aug  7 14:38 datavolume2</span><br><span class="line">drwxr-xr-x  5 root root   360 Aug  7 14:43 dev</span><br><span class="line">drwxr-xr-x  1 root root  4096 Aug  7 14:43 etc</span><br><span class="line">drwxr-xr-x  2 root root  4096 Apr 11  2018 home</span><br><span class="line">lrwxrwxrwx  1 root root     7 Dec  4  2018 lib -&gt; usr/lib</span><br><span class="line">lrwxrwxrwx  1 root root     9 Dec  4  2018 lib64 -&gt; usr/lib64</span><br><span class="line">drwxr-xr-x  2 root root  4096 Apr 11  2018 media</span><br><span class="line">drwxr-xr-x  2 root root  4096 Apr 11  2018 mnt</span><br><span class="line">drwxr-xr-x  2 root root  4096 Apr 11  2018 opt</span><br><span class="line">dr-xr-xr-x 97 root root     0 Aug  7 14:43 proc</span><br><span class="line">dr-xr-x---  2 root root  4096 Dec  4  2018 root</span><br><span class="line">drwxr-xr-x 11 root root  4096 Dec  4  2018 run</span><br><span class="line">lrwxrwxrwx  1 root root     8 Dec  4  2018 sbin -&gt; usr/sbin</span><br><span class="line">drwxr-xr-x  2 root root  4096 Apr 11  2018 srv</span><br><span class="line">dr-xr-xr-x 13 root root     0 Aug  5 01:22 sys</span><br><span class="line">drwxrwxrwt  7 root root  4096 Dec  4  2018 tmp</span><br><span class="line">drwxr-xr-x 13 root root  4096 Dec  4  2018 usr</span><br><span class="line">drwxr-xr-x 18 root root  4096 Dec  4  2018 var</span><br><span class="line">[root@e335b245323b /]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>注意：dv2容器是通过连接数据卷容器dv1去挂载数据卷的，但即使数据卷容器dv1被销毁同时删除数据卷，dv2容器还是能使用数据卷的，就是说如果数据卷还被容器所使用，它就会一直存在。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker run -it --name dv3 datavo1	#启动dv3容器作为数据卷容器</span></span><br><span class="line">[root@4cef0ed4be5e /]<span class="comment"># ls</span></span><br><span class="line">anaconda-post.log  bin  datavolume1  datavolume2  dev  etc  home  lib  lib64  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var</span><br><span class="line">[root@4cef0ed4be5e /]<span class="comment"># touch datavolume1/123</span></span><br><span class="line">[root@4cef0ed4be5e /]<span class="comment"># ll datavolume1/123</span></span><br><span class="line">-rw-r--r-- 1 root root 0 Aug  8 01:09 datavolume1/123</span><br><span class="line"></span><br><span class="line">[root@docker ~]<span class="comment"># docker run --name dv4 -it --volumes-from dv3 centos:7.6.1810 /bin/bash		#启动dv4容器挂载到dv3数据卷容器</span></span><br><span class="line">[root@4c71b0b9f5cd /]<span class="comment"># ls</span></span><br><span class="line">anaconda-post.log  bin  datavolume1  datavolume2  dev  etc  home  lib  lib64  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var</span><br><span class="line">[root@4c71b0b9f5cd /]<span class="comment"># ll /datavolume1</span></span><br><span class="line">total 0</span><br><span class="line">-rw-r--r-- 1 root root 0 Aug  8 01:09 123</span><br><span class="line">[root@4c71b0b9f5cd /]<span class="comment"># touch /datavolume1/456</span></span><br><span class="line"></span><br><span class="line">[root@docker ~]<span class="comment"># docker rm -v dv3	#销毁数据卷容器并删除数据卷</span></span><br><span class="line">dv3</span><br><span class="line"></span><br><span class="line">[root@docker ~]<span class="comment"># docker exec -it dv4 /bin/bash		#即使数据卷容器dv3被删除，dv4容器依然能使用数据卷</span></span><br><span class="line">[root@4c71b0b9f5cd /]<span class="comment"># touch /datavolume1/789</span></span><br><span class="line">[root@4c71b0b9f5cd /]<span class="comment"># ll /datavolume1/789</span></span><br><span class="line">-rw-r--r-- 1 root root 0 Aug  8 01:15 /datavolume1/789</span><br><span class="line">[root@4c71b0b9f5cd /]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="数据卷的备份和还原"><a href="#数据卷的备份和还原" class="headerlink" title="数据卷的备份和还原"></a>数据卷的备份和还原</h2><h3 id="数据卷备份操作原理图"><a href="#数据卷备份操作原理图" class="headerlink" title="数据卷备份操作原理图"></a>数据卷备份操作原理图</h3><p><img alt data-src="https://puui.qpic.cn/fans_admin/0/3_1452557490_1573729927186/0" class="lozad"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker exec -it dv4 /bin/bash		#备份dv4容器的/datavolume1数据卷</span></span><br><span class="line">[root@4c71b0b9f5cd /]<span class="comment"># ls /datavolume1/</span></span><br><span class="line">123  456  789</span><br><span class="line">[root@4c71b0b9f5cd /]<span class="comment"># exit</span></span><br><span class="line"></span><br><span class="line">[root@docker ~]<span class="comment"># docker run --volumes-from dv4 -v /backup/:/con_backup --name dv5 centos:7.6.1810 tar cvf /con_backup/dv4.tar.gz /datavolume1/</span></span><br><span class="line">tar: Removing leading `/<span class="string">' from member names</span></span><br><span class="line"><span class="string">/datavolume1/</span></span><br><span class="line"><span class="string">/datavolume1/456</span></span><br><span class="line"><span class="string">/datavolume1/123</span></span><br><span class="line"><span class="string">/datavolume1/789</span></span><br><span class="line"><span class="string">[root@docker ~]# ls /backup/</span></span><br><span class="line"><span class="string">dv4.tar.gz</span></span><br><span class="line"><span class="string">[root@docker ~]#</span></span><br><span class="line"><span class="string">#启动一个dv5容器，将dv4容器作为数据卷容器挂载，再把dv5容器的/con_backup和宿主机的/backup目录做数据卷映射，这个时候dv4容器数据卷的目录（需要备份的数据），和备份的目录（容器的/con_backup目录和宿主机的/backup目录）已经在一个容器内（dv5），执行tar命令将数据备份到容器的/con_backup/目录，这时候宿主机的/backup目录就有了备份的数据。</span></span><br></pre></td></tr></table></figure>

<h3 id="数据卷还原"><a href="#数据卷还原" class="headerlink" title="数据卷还原"></a>数据卷还原</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@docker ~]<span class="comment"># docker exec -it dv4 /bin/bash		#删除dv4容器数据卷的数据</span></span><br><span class="line">[root@4c71b0b9f5cd /]<span class="comment"># ll /datavolume1/</span></span><br><span class="line">total 0</span><br><span class="line">-rw-r--r-- 1 root root 0 Aug  8 01:09 123</span><br><span class="line">-rw-r--r-- 1 root root 0 Aug  8 01:13 456</span><br><span class="line">-rw-r--r-- 1 root root 0 Aug  8 01:15 789</span><br><span class="line">[root@4c71b0b9f5cd /]<span class="comment"># rm -rf /datavolume1/*</span></span><br><span class="line"></span><br><span class="line">[root@docker ~]<span class="comment"># docker run --volumes-from dv4 -v /backup/:/con_backup --name dv5 centos:7.6.1810 tar xf /con_backup/dv4.tar.gz -C /datavolume1/</span></span><br><span class="line">[root@docker ~]<span class="comment"># docker exec -it dv4 /bin/bash</span></span><br><span class="line">[root@4c71b0b9f5cd /]<span class="comment"># ls /datavolume1/</span></span><br><span class="line">datavolume1</span><br><span class="line">[root@4c71b0b9f5cd /]<span class="comment"># ls /datavolume1/datavolume1/		#由于备份数据的时候没有切换到/datavolume1里面在打包</span></span><br><span class="line">123  456  789</span><br></pre></td></tr></table></figure>

</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">GZ</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://gz1903.github.io/2019/11/14/容器化技术-Docker/">https://gz1903.github.io/2019/11/14/容器化技术-Docker/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://gz1903.github.io">GZ's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Linux/">Linux    </a><a class="post-meta__tags" href="/tags/Docker/">Docker    </a><a class="post-meta__tags" href="/tags/容器化技术/">容器化技术    </a></div><div class="post_share"><div class="social-share" data-image="https://puui.qpic.cn/fans_admin/0/3_902214536_1573730288351/0" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button"><i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lozad post-qr-code__img" src="https://p.pstatp.com/origin/fed50001221f29cc508e"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lozad post-qr-code__img" src="https://p.pstatp.com/origin/ff4e000024ff4dc8593c"><div class="post-qr-code__desc">支付宝</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull-left"><a href="/2019/11/15/Dockerfile构建JDK-Tomcat环境/"><img class="prev_cover lozad" data-src="https://puui.qpic.cn/fans_admin/0/3_1231830080_1573780280556/0" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>Dockerfile构建JDK+Tomcat环境</span></div></a></div><div class="next-post pull-right"><a href="/2019/11/09/Linux科学上网搭建/"><img class="next_cover lozad" data-src="https://puui.qpic.cn/fans_admin/0/3_216703492_1573280915261/0" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>Linux科学上网搭建</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2019/11/15/Dockerfile构建Nginx镜像/" title="Dockerfile构建Nginx镜像"><img class="relatedPosts_cover lozad" data-src="https://puui.qpic.cn/fans_admin/0/3_487719189_1573817412223/0"><div class="relatedPosts_title">Dockerfile构建Nginx镜像</div></a></div><div class="relatedPosts_item"><a href="/2019/11/15/Docker搭建WordPress博客/" title="Docker搭建WordPress博客"><img class="relatedPosts_cover lozad" data-src="https://puui.qpic.cn/fans_admin/0/3_1503767511_1573803906689/0"><div class="relatedPosts_title">Docker搭建WordPress博客</div></a></div><div class="relatedPosts_item"><a href="/2019/11/15/Dockerfile构建JDK-Tomcat环境/" title="Dockerfile构建JDK+Tomcat环境"><img class="relatedPosts_cover lozad" data-src="https://puui.qpic.cn/fans_admin/0/3_1231830080_1573780280556/0"><div class="relatedPosts_title">Dockerfile构建JDK+Tomcat环境</div></a></div><div class="relatedPosts_item"><a href="/2019/11/16/BBR、BBR魔改、BBRPlus、Lotserver锐速，加速效果对比测试/" title="BBR、BBR魔改、BBRPlus、Lotserver锐速，加速效果对比测试"><img class="relatedPosts_cover lozad" data-src="https://puui.qpic.cn/fans_admin/0/3_1976420838_1573888939900/0"><div class="relatedPosts_title">BBR、BBR魔改、BBRPlus、Lotserver锐速，加速效果对比测试</div></a></div><div class="relatedPosts_item"><a href="/2019/11/16/BBR-PLUS一键安装实现Shadowsocks暴力加速/" title="BBR PLUS一键安装实现Shadowsocks暴力加速"><img class="relatedPosts_cover lozad" data-src="https://puui.qpic.cn/fans_admin/0/3_1440820042_1573889513187/0"><div class="relatedPosts_title">BBR PLUS一键安装实现Shadowsocks暴力加速</div></a></div><div class="relatedPosts_item"><a href="/2019/11/09/Linux科学上网搭建/" title="Linux科学上网搭建"><img class="relatedPosts_cover lozad" data-src="https://puui.qpic.cn/fans_admin/0/3_216703492_1573280915261/0"><div class="relatedPosts_title">Linux科学上网搭建</div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = false == true ? true : false;
var verify = true == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;

window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'xR8wxzBarBR90TrLpaMbEUoq-gzGzoHsz',
  appKey:'CBRUy2TKk5aGcEmrUlIPjAqV',
  placeholder:'Please leave your footprints',
  avatar:'monsterid',
  guest_info:guest_info,
  pageSize:'10',
  lang:'zh-cn',
  recordIP: true
});</script></div></div></div><footer style="background-image: url(https://puui.qpic.cn/fans_admin/0/3_902214536_1573730288351/0)"><div id="footer"><div class="copyright">&copy;2019 By GZ</div><div class="framework-info"><span>个人专属 </span><a href="https://github.com/GZ1903"><span>-Github</span></a><span class="footer-separator">|</span><span>博客 </span><a href="https://gz1903.github.io/"><span>-GZ</span></a></div><div class="footer_custom_text">Hi, welcome to my <a href="https://gz1903.github.io/">blog</a>!</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换">简</a><i class="nightshift fa fa-moon-o" id="nightshift" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script async src="/js/search/algolia.js"></script><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="/js/third-party/fireworks.js"></script><script src="/js/nightshift.js"></script><script id="ribbon" src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/js/piao.js"></script><script src="/js/baidupush.js"> </script><script src="/js/activate-power-mode.js"></script><script>POWERMODE.colorful = true; // make power mode colorful
POWERMODE.shake = true; // turn off shake
document.body.addEventListener('input', POWERMODE);
</script><script src="/js/tw_cn.js"></script><script>translateInitilization()

</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@1.2.2/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script><script>const observer = lozad(); // lazy loads elements with default selector as '.lozad'
observer.observe();
</script><div class="search-dialog" id="algolia-search"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"superSample":2,"width":150,"height":300,"position":"right","hOffset":100,"vOffset":-50},"mobile":{"show":false,"scale":0.5}});</script></body></html>